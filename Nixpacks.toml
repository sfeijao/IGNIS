# Explicit Nixpacks config to control build and caching

# The plan: use npm install (not ci) to avoid removing node_modules and breaking the cache mount.
# Also, do not cache node_modules/.cache to avoid EBUSY issues.

[phases.setup]
# no-op: rely on default Node detection

[phases.install]
cmd = "npm ci"

[phases.build]
cmd = "npm install --no-audit --no-fund && npm --prefix dashboard/next install --no-audit --no-fund && npm --prefix dashboard/next run build"

[phases.start]
cmd = "npm start"

[caches]
# Disable caching the problematic path explicitly
paths = []

