(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[146],{3871:function(e,a,s){Promise.resolve().then(s.bind(s,4271))},4271:function(e,a,s){"use strict";s.d(a,{default:function(){return d}});var l=s(7437),t=s(2265),n=s(2837),i=s(9988),c=s(7814);function d(){let{t:e}=(0,c.QT)(),[a,s]=(0,t.useState)(null),[d,r]=(0,t.useState)([]),[p,o]=(0,t.useState)(!1),[u,m]=(0,t.useState)(null),[h,x]=(0,t.useState)({}),[b,j]=(0,t.useState)("pending"),[g,f]=(0,t.useState)(""),[v,N]=(0,t.useState)(!1),[y,w]=(0,t.useState)(0);(0,t.useEffect)(()=>{s((0,n._)())},[]);let C=async a=>{o(!0),m(null);try{let e={};b&&"all"!==b&&(e.status=b);let s=await i.h.getAppeals(a,e);r((null==s?void 0:s.appeals)||s||[])}catch(a){m((null==a?void 0:a.message)||e("appeals.loadFailed"))}finally{o(!1)}};(0,t.useEffect)(()=>{a&&(w(0),C(a))},[a,b]);let S=async(e,s)=>{if(a){o(!0);try{await i.h.decideAppeal(a,e,"approve"===s?"accepted":"rejected",h[e]),await C(a)}finally{o(!1)}}},k=(0,t.useMemo)(()=>g.trim()?d.filter(e=>[e.userId,e.caseId,e.reason,e.status].map(e=>(e||"").toLowerCase()).join(" ").includes(g.trim().toLowerCase())):d,[d,g]),_=(0,t.useMemo)(()=>k.slice(20*y,20*y+20),[k,y]),M=Math.max(1,Math.ceil(k.length/20)),E=Array.from({length:4}).map((e,a)=>(0,l.jsxs)("div",{className:"p-3 rounded-lg bg-neutral-800/30 border border-neutral-800 animate-pulse",children:[(0,l.jsx)("div",{className:"h-3 w-32 bg-neutral-700 rounded mb-2"}),(0,l.jsx)("div",{className:"h-3 w-48 bg-neutral-700 rounded mb-2"}),(0,l.jsx)("div",{className:"h-8 w-full bg-neutral-700/60 rounded"})]},a));return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold",children:e("appeals.title")}),(0,l.jsx)("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:()=>a&&C(a),title:e("common.reload"),children:e("common.reload")})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,l.jsxs)("select",{className:"input w-32",value:b,onChange:e=>j(e.target.value),"aria-label":e("appeals.filter.status"),title:e("appeals.filter.status"),children:[(0,l.jsx)("option",{value:"pending",children:e("appeals.filter.pending")}),(0,l.jsx)("option",{value:"accepted",children:e("appeals.filter.accepted")}),(0,l.jsx)("option",{value:"rejected",children:e("appeals.filter.rejected")}),(0,l.jsx)("option",{value:"all",children:e("appeals.filter.all")})]}),(0,l.jsx)("input",{className:"input w-48",placeholder:e("appeals.search.placeholder"),"aria-label":e("appeals.search.title"),title:e("appeals.search.title"),value:g,onChange:e=>{f(e.target.value),w(0)}}),(0,l.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,l.jsxs)("span",{children:[k.length," ",e("appeals.count")]}),M>1&&(0,l.jsxs)("div",{className:"flex items-center gap-1",children:[(0,l.jsx)("button",{type:"button",className:"btn btn-secondary btn-xs",disabled:0===y,onClick:()=>w(e=>Math.max(0,e-1)),children:"<"}),(0,l.jsxs)("span",{className:"opacity-70",children:[y+1,"/",M]}),(0,l.jsx)("button",{type:"button",className:"btn btn-secondary btn-xs",disabled:y>=M-1,onClick:()=>w(e=>Math.min(M-1,e+1)),children:">"})]})]})]})]}),u&&(0,l.jsx)("div",{className:"text-red-400",children:u}),(0,l.jsxs)("section",{className:"card",children:[(0,l.jsx)("div",{className:"card-header",children:e("appeals.queue")}),(0,l.jsxs)("div",{className:"card-body grid gap-3",role:"status","aria-live":"polite","aria-busy":p,children:[p&&(0,l.jsx)("div",{className:"grid md:grid-cols-2 gap-3",children:E}),!p&&0===_.length&&(0,l.jsx)("div",{className:"opacity-70",children:e("appeals.empty")}),!p&&_.map(a=>(0,l.jsxs)("div",{className:"p-3 rounded-lg bg-neutral-800/50 border border-neutral-800",children:[(0,l.jsxs)("div",{className:"text-sm opacity-70",children:[a.userId," • ",e("appeals.case")," ",a.caseId," • ",new Date(a.createdAt||Date.now()).toLocaleString()]}),(0,l.jsxs)("div",{className:"mt-1",children:[e("appeals.reason"),": ",a.reason||e("appeals.reason.empty")]}),(0,l.jsxs)("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-2 items-end",children:[(0,l.jsxs)("label",{className:"flex flex-col gap-1 md:col-span-2",children:[(0,l.jsx)("span",{className:"text-sm opacity-80",children:e("appeals.decision.justification")}),(0,l.jsx)("input",{className:"input",value:h[a.id]||"",onChange:e=>x(s=>({...s,[a.id]:e.target.value})),placeholder:e("appeals.decision.placeholder"),title:e("appeals.decision.title")})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{type:"button",className:"btn btn-primary btn-xs",onClick:()=>S(a.id,"approve"),children:e("appeals.approve")}),(0,l.jsx)("button",{type:"button",className:"btn btn-danger btn-xs",onClick:()=>S(a.id,"deny"),children:e("appeals.deny")})]})]})]},a.id))]})]})]})}}},function(e){e.O(0,[814,482,971,23,744],function(){return e(e.s=3871)}),_N_E=e.O()}]);