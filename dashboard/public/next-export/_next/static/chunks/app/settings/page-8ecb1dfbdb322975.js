(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{7147:function(e,t,n){Promise.resolve().then(n.bind(n,3989))},3989:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var l=n(7437),a=n(2265),r=n(9988),s=n(2837),i=n(7814),o=n(8183);let c={prefix:"!",locale:"pt",logsEnabled:!0,modlogChannelId:""};function d(){let[e,t]=(0,a.useState)(c),[n,d]=(0,a.useState)({nickname:"",presenceStatus:"online",statusType:"CUSTOM",statusText:"",bannerUrl:"",iconUrl:""}),[u,g]=(0,a.useState)(!1),[p,m]=(0,a.useState)(!1),[h,b]=(0,a.useState)(!1),[x,v]=(0,a.useState)(!1),f=(0,s._)(),{t:y}=(0,i.QT)(),{toast:j}=(0,o.p)(),[w,N]=(0,a.useState)([]),[T,C]=(0,a.useState)(!1),k=e=>{switch(String("string"==typeof e?e:(null==e?void 0:e.type)||"").toLowerCase()){case"guild_text":case"text":return"Text";case"guild_announcement":case"announcement":return"Announcement";case"guild_voice":case"voice":return"Voice";case"guild_category":case"category":return"Category";default:return"Channel"}};(0,a.useEffect)(()=>{f&&(async()=>{var e,n,l,a,s,i;try{let i=await (null===(e=r.h.getSettings)||void 0===e?void 0:e.call(r.h,f));i&&t({prefix:null!==(n=i.prefix)&&void 0!==n?n:c.prefix,locale:null!==(l=i.locale)&&void 0!==l?l:c.locale,logsEnabled:null!==(a=i.logsEnabled)&&void 0!==a?a:c.logsEnabled,modlogChannelId:null!==(s=i.modlogChannelId)&&void 0!==s?s:c.modlogChannelId})}catch(e){}try{let e=await (null===(i=r.h.getBotSettings)||void 0===i?void 0:i.call(r.h,f)),t=e&&e.settings||e||{};d(e=>({nickname:"string"==typeof t.nickname?t.nickname:"",presenceStatus:t.presenceStatus||"online",statusType:t.statusType||"CUSTOM",statusText:"string"==typeof t.statusText?t.statusText:"",bannerUrl:"string"==typeof t.bannerUrl?t.bannerUrl:"",iconUrl:"string"==typeof t.iconUrl?t.iconUrl:""}))}catch(e){}try{let e=await r.h.getChannels(f);N(e.channels||e||[])}catch(e){}v(!0)})()},[f]),(0,a.useEffect)(()=>{if(f)try{let e="ignis:bannerCropToFill:".concat(f),t=window.localStorage.getItem(e);null!=t&&C("1"===t)}catch(e){}},[f]),(0,a.useEffect)(()=>{if(f)try{let e="ignis:bannerCropToFill:".concat(f);window.localStorage.setItem(e,T?"1":"0")}catch(e){}},[f,T]);let U=async()=>{if(f){b(!0);try{var t,l;await (null===(t=r.h.postSettings)||void 0===t?void 0:t.call(r.h,f,e));let a={nickname:n.nickname||"",presenceStatus:n.presenceStatus||"online",statusType:n.statusType||"CUSTOM",statusText:n.statusText||""};n.bannerUrl&&(a.bannerUrl=n.bannerUrl),n.iconUrl&&(a.iconUrl=n.iconUrl),await (null===(l=r.h.postBotSettings)||void 0===l?void 0:l.call(r.h,f,a)),j({type:"success",title:y("settings.saveSuccess")})}catch(e){j({type:"error",title:y("settings.saveError")})}finally{b(!1)}}},S=async e=>{if(f&&e){if(!/^image\//i.test(e.type)){j({type:"error",title:y("settings.bot.banner.typeError")});return}if(e.size>12582912){j({type:"error",title:y("settings.bot.banner.sizeError")});return}g(!0);try{let t=await new Promise((t,n)=>{let l=new FileReader;l.onload=()=>t(String(l.result||"")),l.onerror=n,l.readAsDataURL(e)}),n=async(e,t)=>{if(/image\/gif/i.test(t.type))return e;let n=await new Promise((t,n)=>{let l=new Image;l.onload=()=>t(l),l.onerror=n,l.src=e}),l=n.naturalWidth||n.width,a=n.naturalHeight||n.height;if(!l||!a)return e;let r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return e;if(T){if(l<1600&&a<400)return e;let t=l/a,i=0,o=0,c=l,d=a;t>4?(c=Math.floor(4*a),i=Math.floor((l-c)/2)):t<4&&(d=Math.floor(l/4),o=Math.floor((a-d)/2)),r.width=1600,r.height=400,s.drawImage(n,i,o,c,d,0,0,1600,400)}else{let t=Math.min(1,Math.min(1600/l,400/a));if(t>=1)return e;let i=Math.max(1,Math.floor(l*t)),o=Math.max(1,Math.floor(a*t));r.width=i,r.height=o,s.drawImage(n,0,0,i,o)}try{return r.toDataURL("image/webp",.85)}catch(e){return r.toDataURL("image/jpeg",.85)}},l=await n(t,e),a=await r.h.uploadGuildImage(f,e.name,l);a&&a.success&&a.url?(d(e=>({...e,bannerUrl:a.url})),j({type:"success",title:y("settings.bot.banner.uploaded")})):j({type:"error",title:y("settings.bot.banner.uploadFail")})}catch(e){j({type:"error",title:y("settings.bot.banner.uploadFail")})}finally{g(!1)}}},E=async e=>{if(f&&e){if(!/^image\//i.test(e.type)){j({type:"error",title:y("settings.bot.icon.typeError")});return}if(e.size>12582912){j({type:"error",title:y("settings.bot.icon.sizeError")});return}m(!0);try{let t=await new Promise((t,n)=>{let l=new FileReader;l.onload=()=>t(String(l.result||"")),l.onerror=n,l.readAsDataURL(e)}),n=async(e,t)=>{if(/image\/gif/i.test(t.type))return e;let n=await new Promise((t,n)=>{let l=new Image;l.onload=()=>t(l),l.onerror=n,l.src=e}),l=n.naturalWidth||n.width,a=n.naturalHeight||n.height;if(!l||!a)return e;let r=Math.min(1,Math.min(256/l,256/a));if(r>=1)return e;let s=Math.max(1,Math.floor(l*r)),i=Math.max(1,Math.floor(a*r)),o=document.createElement("canvas");o.width=s,o.height=i;let c=o.getContext("2d");if(!c)return e;c.drawImage(n,0,0,s,i);try{return o.toDataURL("image/webp",.9)}catch(e){return o.toDataURL("image/jpeg",.9)}},l=await n(t,e),a=await r.h.uploadGuildImage(f,e.name,l);(null==a?void 0:a.success)&&a.url?(d(e=>({...e,iconUrl:a.url})),j({type:"success",title:y("settings.bot.icon.uploaded")})):j({type:"error",title:y("settings.bot.icon.uploadFail")})}catch(e){j({type:"error",title:y("settings.bot.icon.uploadFail")})}finally{m(!1)}}};return(0,l.jsxs)("form",{className:"card p-5 max-w-xl space-y-4",onSubmit:e=>{e.preventDefault(),U()},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"prefix",className:"block text-sm mb-1",children:y("settings.prefix")}),(0,l.jsx)("input",{id:"prefix",title:y("settings.prefix"),placeholder:y("settings.prefix.placeholder"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:e.prefix,onChange:e=>t(t=>({...t,prefix:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"locale",className:"block text-sm mb-1",children:y("settings.locale")}),(0,l.jsxs)("select",{id:"locale",title:y("settings.locale"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:e.locale,onChange:e=>t(t=>({...t,locale:e.target.value})),children:[(0,l.jsx)("option",{value:"pt",children:y("settings.locale.pt")}),(0,l.jsx)("option",{value:"en",children:y("settings.locale.en")})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{id:"logsEnabled",type:"checkbox",className:"h-4 w-4",checked:e.logsEnabled,onChange:e=>t(t=>({...t,logsEnabled:e.target.checked}))}),(0,l.jsx)("label",{htmlFor:"logsEnabled",className:"text-sm",children:y("settings.logsEnabled")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"modlog",className:"block text-sm mb-1",children:y("settings.modlogChannelId")}),(0,l.jsxs)("select",{id:"modlog",title:y("settings.modlogChannelId"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:e.modlogChannelId,onChange:e=>t(t=>({...t,modlogChannelId:e.target.value})),children:[(0,l.jsx)("option",{value:"",children:"â€”"}),w.filter(e=>{let t=String(e.type||"").toLowerCase();return t.includes("text")||t.includes("announcement")}).map(e=>(0,l.jsx)("option",{value:e.id,children:"#".concat(e.name," (").concat(k(e),")")},e.id))]})]}),(0,l.jsxs)("div",{className:"mt-6 pt-4 border-t border-neutral-800",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-3",children:y("settings.bot.title")}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"nickname",className:"block text-sm mb-1",children:y("settings.bot.nickname")}),(0,l.jsx)("input",{id:"nickname",placeholder:y("settings.bot.nickname.placeholder"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.nickname||"",onChange:e=>d(t=>({...t,nickname:e.target.value}))}),(0,l.jsx)("p",{className:"text-xs text-neutral-400 mt-1",children:y("settings.bot.nickname.hint")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"presenceStatus",className:"block text-sm mb-1",children:y("settings.bot.presence")}),(0,l.jsxs)("select",{id:"presenceStatus",className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.presenceStatus||"online",onChange:e=>d(t=>({...t,presenceStatus:e.target.value})),children:[(0,l.jsx)("option",{value:"online",children:y("settings.bot.presence.online")}),(0,l.jsx)("option",{value:"idle",children:y("settings.bot.presence.idle")}),(0,l.jsx)("option",{value:"dnd",children:y("settings.bot.presence.dnd")}),(0,l.jsx)("option",{value:"invisible",children:y("settings.bot.presence.offline")})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"statusType",className:"block text-sm mb-1",children:y("settings.bot.activityType")}),(0,l.jsxs)("select",{id:"statusType",className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.statusType||"CUSTOM",onChange:e=>d(t=>({...t,statusType:e.target.value})),children:[(0,l.jsx)("option",{value:"PLAYING",children:y("settings.bot.activityType.playing")}),(0,l.jsx)("option",{value:"LISTENING",children:y("settings.bot.activityType.listening")}),(0,l.jsx)("option",{value:"WATCHING",children:y("settings.bot.activityType.watching")}),(0,l.jsx)("option",{value:"COMPETING",children:y("settings.bot.activityType.competing")}),(0,l.jsx)("option",{value:"CUSTOM",children:y("settings.bot.activityType.custom")})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"statusText",className:"block text-sm mb-1",children:y("settings.bot.activityText")}),(0,l.jsx)("input",{id:"statusText",placeholder:y("settings.bot.activityText.placeholder"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.statusText||"",onChange:e=>d(t=>({...t,statusText:e.target.value}))})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"bannerUrl",className:"block text-sm mb-1",children:y("settings.bot.banner")}),(0,l.jsx)("input",{id:"bannerUrl",placeholder:y("settings.bot.banner.placeholder"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.bannerUrl||"",onChange:e=>d(t=>({...t,bannerUrl:e.target.value}))}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,l.jsxs)("label",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md bg-neutral-800 hover:bg-neutral-700 cursor-pointer",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{let t=e.target.files&&e.target.files[0];t&&S(t),e.target.value=""}}),(0,l.jsx)("span",{children:u?y("settings.bot.banner.uploading"):y("settings.bot.banner.upload")})]}),(0,l.jsx)("span",{className:"text-xs text-neutral-400",children:y("settings.bot.banner.hint")})]}),(0,l.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,l.jsx)("input",{id:"bannerCropToFill",type:"checkbox",className:"h-4 w-4",checked:T,onChange:e=>C(e.target.checked)}),(0,l.jsx)("label",{htmlFor:"bannerCropToFill",className:"text-sm",children:y("settings.bot.banner.cropToFill")})]}),(0,l.jsx)("p",{className:"text-xs text-neutral-500 mt-1",children:y("settings.bot.banner.cropHint")}),(0,l.jsxs)("div",{onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{var t,n;e.preventDefault(),e.stopPropagation();let l=null===(n=e.dataTransfer)||void 0===n?void 0:null===(t=n.files)||void 0===t?void 0:t[0];l&&S(l)},className:"mt-3 rounded-lg border-2 border-dashed border-neutral-700 hover:border-neutral-500 transition-colors p-4 text-center text-sm text-neutral-300 cursor-pointer",onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{var t,n;let l=null===(n=e.target)||void 0===n?void 0:null===(t=n.files)||void 0===t?void 0:t[0];l&&S(l)},e.click()},"aria-label":y("settings.bot.banner.dropHint"),title:y("settings.bot.banner.dropHint"),children:[(0,l.jsx)("div",{className:"opacity-90",children:y("settings.bot.banner.dropHint")}),(0,l.jsx)("div",{className:"text-xs text-neutral-500 mt-1",children:y("settings.bot.banner.limit")})]}),n.bannerUrl?(0,l.jsx)("div",{className:"mt-3 border border-neutral-800 rounded-lg overflow-hidden",children:(0,l.jsx)("img",{src:n.bannerUrl,alt:y("settings.bot.banner.previewAlt"),className:"w-full h-40 object-cover"})}):null]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"iconUrl",className:"block text-sm mb-1",children:y("settings.bot.icon")}),(0,l.jsx)("input",{id:"iconUrl",placeholder:y("settings.bot.icon.placeholder"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.iconUrl||"",onChange:e=>d(t=>({...t,iconUrl:e.target.value}))}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,l.jsxs)("label",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md bg-neutral-800 hover:bg-neutral-700 cursor-pointer",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];n&&E(n),e.target.value=""}}),(0,l.jsx)("span",{children:p?y("settings.bot.icon.uploading"):y("settings.bot.icon.upload")})]}),(0,l.jsx)("span",{className:"text-xs text-neutral-400",children:y("settings.bot.icon.hint")})]}),(0,l.jsxs)("div",{onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{var t,n;e.preventDefault(),e.stopPropagation();let l=null===(n=e.dataTransfer)||void 0===n?void 0:null===(t=n.files)||void 0===t?void 0:t[0];l&&E(l)},className:"mt-3 rounded-lg border-2 border-dashed border-neutral-700 hover:border-neutral-500 transition-colors p-4 text-center text-sm text-neutral-300 cursor-pointer",onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{var t,n;let l=null===(n=e.target)||void 0===n?void 0:null===(t=n.files)||void 0===t?void 0:t[0];l&&E(l)},e.click()},"aria-label":y("settings.bot.icon.dropHint"),title:y("settings.bot.icon.dropHint"),children:[(0,l.jsx)("div",{className:"opacity-90",children:y("settings.bot.icon.dropHint")}),(0,l.jsx)("div",{className:"text-xs text-neutral-500 mt-1",children:y("settings.bot.icon.limit")})]}),n.iconUrl?(0,l.jsx)("div",{className:"mt-3 inline-flex items-center gap-3",children:(0,l.jsx)("img",{src:n.iconUrl,alt:y("settings.bot.icon.previewAlt"),className:"w-16 h-16 rounded object-cover border border-neutral-800"})}):null]})]})]}),(0,l.jsx)("div",{className:"flex gap-2 pt-2",children:(0,l.jsx)("button",{type:"submit",disabled:h,className:"px-4 py-2 rounded-lg bg-brand-600 hover:bg-brand-700 font-medium disabled:opacity-60",children:h?y("settings.saving"):x?y("settings.save"):y("settings.loading")})})]})}function u(){let{t:e}=(0,i.QT)();return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:e("settings.title")}),(0,l.jsx)(d,{})]})}},8183:function(e,t,n){"use strict";n.d(t,{ToasterProvider:function(){return i},p:function(){return s}});var l=n(7437),a=n(2265);let r=(0,a.createContext)(null);function s(){let e=(0,a.useContext)(r);if(!e)throw Error("useToast must be used within <ToasterProvider />");return e}function i(e){let{children:t}=e,[n,s]=(0,a.useState)([]),i=(0,a.useRef)(0),o=(0,a.useCallback)(e=>{s(t=>t.filter(t=>t.id!==e))},[]),c=(0,a.useCallback)(e=>{let t="".concat(Date.now(),"_").concat(i.current++),n={id:t,...e};s(e=>[...e,n]),window.setTimeout(()=>o(t),4500)},[o]),d=(0,a.useMemo)(()=>({toast:c}),[c]);return(0,l.jsxs)(r.Provider,{value:d,children:[t,(0,l.jsx)("div",{className:"fixed z-50 right-4 bottom-4 flex flex-col gap-2 w-[min(92vw,380px)]",role:"status","aria-live":"polite",children:n.map(e=>(0,l.jsxs)("div",{className:"rounded-xl border p-3 shadow-lg backdrop-blur card ".concat("success"===e.type?"border-emerald-700/60":"error"===e.type?"border-rose-700/60":"border-neutral-700/60"),children:[e.title&&(0,l.jsx)("div",{className:"text-sm font-semibold mb-0.5",children:e.title}),e.description&&(0,l.jsx)("div",{className:"text-xs text-neutral-300",children:e.description})]},e.id))})]})}}},function(e){e.O(0,[814,482,971,23,744],function(){return e(e.s=7147)}),_N_E=e.O()}]);