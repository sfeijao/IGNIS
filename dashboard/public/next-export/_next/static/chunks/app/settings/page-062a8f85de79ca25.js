(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[938],{7147:function(e,t,n){Promise.resolve().then(n.bind(n,3989))},3989:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var l=n(7437),a=n(2265),s=n(9988),r=n(2837),i=n(7814);let o={prefix:"!",locale:"pt",logsEnabled:!0,modlogChannelId:""};function c(){let[e,t]=(0,a.useState)(o),[n,c]=(0,a.useState)({nickname:"",presenceStatus:"online",statusType:"CUSTOM",statusText:"",bannerUrl:""}),[d,u]=(0,a.useState)(!1),[g,p]=(0,a.useState)(!1),[b,h]=(0,a.useState)(!1),m=(0,r._)(),{t:x}=(0,i.QT)(),[v,f]=(0,a.useState)([]),y=e=>{switch(String("string"==typeof e?e:(null==e?void 0:e.type)||"").toLowerCase()){case"guild_text":case"text":return"Text";case"guild_announcement":case"announcement":return"Announcement";case"guild_voice":case"voice":return"Voice";case"guild_category":case"category":return"Category";default:return"Channel"}};(0,a.useEffect)(()=>{m&&(async()=>{var e,n,l,a,r,i;try{let i=await (null===(e=s.h.getSettings)||void 0===e?void 0:e.call(s.h,m));i&&t({prefix:null!==(n=i.prefix)&&void 0!==n?n:o.prefix,locale:null!==(l=i.locale)&&void 0!==l?l:o.locale,logsEnabled:null!==(a=i.logsEnabled)&&void 0!==a?a:o.logsEnabled,modlogChannelId:null!==(r=i.modlogChannelId)&&void 0!==r?r:o.modlogChannelId})}catch(e){}try{let e=await (null===(i=s.h.getBotSettings)||void 0===i?void 0:i.call(s.h,m)),t=e&&e.settings||e||{};c(e=>({nickname:"string"==typeof t.nickname?t.nickname:"",presenceStatus:t.presenceStatus||"online",statusType:t.statusType||"CUSTOM",statusText:"string"==typeof t.statusText?t.statusText:"",bannerUrl:"string"==typeof t.bannerUrl?t.bannerUrl:""}))}catch(e){}try{let e=await s.h.getChannels(m);f(e.channels||e||[])}catch(e){}h(!0)})()},[m]);let j=async()=>{if(m){p(!0);try{var t,l;await (null===(t=s.h.postSettings)||void 0===t?void 0:t.call(s.h,m,e));let a={nickname:n.nickname||"",presenceStatus:n.presenceStatus||"online",statusType:n.statusType||"CUSTOM",statusText:n.statusText||""};n.bannerUrl&&(a.bannerUrl=n.bannerUrl),await (null===(l=s.h.postBotSettings)||void 0===l?void 0:l.call(s.h,m,a))}finally{p(!1)}}},N=async e=>{if(m&&e){if(!/^image\//i.test(e.type)){alert(x("settings.bot.banner.typeError"));return}if(e.size>2621440){alert(x("settings.bot.banner.sizeError"));return}u(!0);try{let t=await new Promise((t,n)=>{let l=new FileReader;l.onload=()=>t(String(l.result||"")),l.onerror=n,l.readAsDataURL(e)}),n=async(e,t)=>{if(/image\/gif/i.test(t.type))return e;let n=await new Promise((t,n)=>{let l=new Image;l.onload=()=>t(l),l.onerror=n,l.src=e}),l=n.naturalWidth||n.width,a=n.naturalHeight||n.height;if(!l||!a)return e;let s=Math.min(1,Math.min(1600/l,400/a));if(s>=1)return e;let r=Math.max(1,Math.floor(l*s)),i=Math.max(1,Math.floor(a*s)),o=document.createElement("canvas");o.width=r,o.height=i;let c=o.getContext("2d");if(!c)return e;c.drawImage(n,0,0,r,i);try{return o.toDataURL("image/webp",.85)}catch(e){return o.toDataURL("image/jpeg",.85)}},l=await n(t,e),a=await s.h.uploadGuildImage(m,e.name,l);a&&a.success&&a.url?c(e=>({...e,bannerUrl:a.url})):alert(x("settings.bot.banner.uploadFail"))}catch(e){alert(x("settings.bot.banner.uploadFail"))}finally{u(!1)}}};return(0,l.jsxs)("form",{className:"card p-5 max-w-xl space-y-4",onSubmit:e=>{e.preventDefault(),j()},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"prefix",className:"block text-sm mb-1",children:x("settings.prefix")}),(0,l.jsx)("input",{id:"prefix",title:x("settings.prefix"),placeholder:x("settings.prefix.placeholder"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:e.prefix,onChange:e=>t(t=>({...t,prefix:e.target.value}))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"locale",className:"block text-sm mb-1",children:x("settings.locale")}),(0,l.jsxs)("select",{id:"locale",title:x("settings.locale"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:e.locale,onChange:e=>t(t=>({...t,locale:e.target.value})),children:[(0,l.jsx)("option",{value:"pt",children:x("settings.locale.pt")}),(0,l.jsx)("option",{value:"en",children:x("settings.locale.en")})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{id:"logsEnabled",type:"checkbox",className:"h-4 w-4",checked:e.logsEnabled,onChange:e=>t(t=>({...t,logsEnabled:e.target.checked}))}),(0,l.jsx)("label",{htmlFor:"logsEnabled",className:"text-sm",children:x("settings.logsEnabled")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"modlog",className:"block text-sm mb-1",children:x("settings.modlogChannelId")}),(0,l.jsxs)("select",{id:"modlog",title:x("settings.modlogChannelId"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:e.modlogChannelId,onChange:e=>t(t=>({...t,modlogChannelId:e.target.value})),children:[(0,l.jsx)("option",{value:"",children:"â€”"}),v.filter(e=>{let t=String(e.type||"").toLowerCase();return t.includes("text")||t.includes("announcement")}).map(e=>(0,l.jsx)("option",{value:e.id,children:"#".concat(e.name," (").concat(y(e),")")},e.id))]})]}),(0,l.jsxs)("div",{className:"mt-6 pt-4 border-t border-neutral-800",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-3",children:x("settings.bot.title")}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"nickname",className:"block text-sm mb-1",children:x("settings.bot.nickname")}),(0,l.jsx)("input",{id:"nickname",placeholder:x("settings.bot.nickname.placeholder"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.nickname||"",onChange:e=>c(t=>({...t,nickname:e.target.value}))}),(0,l.jsx)("p",{className:"text-xs text-neutral-400 mt-1",children:x("settings.bot.nickname.hint")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"presenceStatus",className:"block text-sm mb-1",children:x("settings.bot.presence")}),(0,l.jsxs)("select",{id:"presenceStatus",className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.presenceStatus||"online",onChange:e=>c(t=>({...t,presenceStatus:e.target.value})),children:[(0,l.jsx)("option",{value:"online",children:x("settings.bot.presence.online")}),(0,l.jsx)("option",{value:"idle",children:x("settings.bot.presence.idle")}),(0,l.jsx)("option",{value:"dnd",children:x("settings.bot.presence.dnd")}),(0,l.jsx)("option",{value:"invisible",children:x("settings.bot.presence.offline")})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"statusType",className:"block text-sm mb-1",children:x("settings.bot.activityType")}),(0,l.jsxs)("select",{id:"statusType",className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.statusType||"CUSTOM",onChange:e=>c(t=>({...t,statusType:e.target.value})),children:[(0,l.jsx)("option",{value:"PLAYING",children:x("settings.bot.activityType.playing")}),(0,l.jsx)("option",{value:"LISTENING",children:x("settings.bot.activityType.listening")}),(0,l.jsx)("option",{value:"WATCHING",children:x("settings.bot.activityType.watching")}),(0,l.jsx)("option",{value:"COMPETING",children:x("settings.bot.activityType.competing")}),(0,l.jsx)("option",{value:"CUSTOM",children:x("settings.bot.activityType.custom")})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"statusText",className:"block text-sm mb-1",children:x("settings.bot.activityText")}),(0,l.jsx)("input",{id:"statusText",placeholder:x("settings.bot.activityText.placeholder"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.statusText||"",onChange:e=>c(t=>({...t,statusText:e.target.value}))})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{htmlFor:"bannerUrl",className:"block text-sm mb-1",children:x("settings.bot.banner")}),(0,l.jsx)("input",{id:"bannerUrl",placeholder:x("settings.bot.banner.placeholder"),className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:n.bannerUrl||"",onChange:e=>c(t=>({...t,bannerUrl:e.target.value}))}),(0,l.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,l.jsxs)("label",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-md bg-neutral-800 hover:bg-neutral-700 cursor-pointer",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:e=>{let t=e.target.files&&e.target.files[0];t&&N(t),e.target.value=""}}),(0,l.jsx)("span",{children:d?x("settings.bot.banner.uploading"):x("settings.bot.banner.upload")})]}),(0,l.jsx)("span",{className:"text-xs text-neutral-400",children:x("settings.bot.banner.hint")})]}),(0,l.jsxs)("div",{onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{var t,n;e.preventDefault(),e.stopPropagation();let l=null===(n=e.dataTransfer)||void 0===n?void 0:null===(t=n.files)||void 0===t?void 0:t[0];l&&N(l)},className:"mt-3 rounded-lg border-2 border-dashed border-neutral-700 hover:border-neutral-500 transition-colors p-4 text-center text-sm text-neutral-300 cursor-pointer",onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.onchange=e=>{var t,n;let l=null===(n=e.target)||void 0===n?void 0:null===(t=n.files)||void 0===t?void 0:t[0];l&&N(l)},e.click()},"aria-label":x("settings.bot.banner.dropHint"),title:x("settings.bot.banner.dropHint"),children:[(0,l.jsx)("div",{className:"opacity-90",children:x("settings.bot.banner.dropHint")}),(0,l.jsx)("div",{className:"text-xs text-neutral-500 mt-1",children:x("settings.bot.banner.limit")})]}),n.bannerUrl?(0,l.jsx)("div",{className:"mt-3 border border-neutral-800 rounded-lg overflow-hidden",children:(0,l.jsx)("img",{src:n.bannerUrl,alt:x("settings.bot.banner.previewAlt"),className:"w-full h-40 object-cover"})}):null]})]})]}),(0,l.jsx)("div",{className:"flex gap-2 pt-2",children:(0,l.jsx)("button",{type:"submit",disabled:g,className:"px-4 py-2 rounded-lg bg-brand-600 hover:bg-brand-700 font-medium disabled:opacity-60",children:g?x("settings.saving"):b?x("settings.save"):x("settings.loading")})})]})}function d(){let{t:e}=(0,i.QT)();return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:e("settings.title")}),(0,l.jsx)(c,{})]})}}},function(e){e.O(0,[814,482,971,23,744],function(){return e(e.s=7147)}),_N_E=e.O()}]);