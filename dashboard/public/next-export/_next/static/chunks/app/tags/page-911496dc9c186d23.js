(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{2176:function(e,t,r){Promise.resolve().then(r.bind(r,7960)),Promise.resolve().then(r.bind(r,912)),Promise.resolve().then(r.bind(r,1481))},7960:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var a=r(7437),l=r(2265),n=r(2837),s=r(9988),o=r(7814),i=r(8183);function d(){let e=(0,n._)(),{t}=(0,o.QT)(),{toast:r}=(0,i.p)(),[d,c]=(0,l.useState)([]),[u,m]=(0,l.useState)(null),[p,x]=(0,l.useState)(""),[b,h]=(0,l.useState)(!1),[g,f]=(0,l.useState)([]),[v,y]=(0,l.useState)(!1),[j,N]=(0,l.useState)(""),[w,C]=(0,l.useState)(""),[k,S]=(0,l.useState)([]),[A,P]=(0,l.useState)(new Set),[F,T]=(0,l.useState)(""),_=(0,l.useMemo)(()=>d.filter(e=>!p||e.name.toLowerCase().includes(p.toLowerCase())||e.prefix.toLowerCase().includes(p.toLowerCase())),[d,p]),E=async()=>{if(e){h(!0);try{let t=await s.h.getTags(e);c(t.tags||[]);try{let t=await s.h.getRoles(e),r=(t.roles||t||[]).map(e=>({id:e.id,name:e.name,manageable:e.manageable}));f(r)}catch(e){f([])}}finally{h(!1)}}};(0,l.useEffect)(()=>{E()},[e]);let R=async()=>{if(!e||!u)return;let a=(u.name||"").trim(),l=(u.prefix||"").trim();if(!a||!l){r({type:"error",title:t("common.saveFailed")||"Falha ao guardar",description:t("tags.validation.namePrefix")||"Nome e prefixo s\xe3o obrigat\xf3rios."});return}let n=function(e){let t=(e||"").trim();if(!t)return"";let r=t.match(/^#?([0-9a-fA-F]{3})$/),a=t.match(/^#?([0-9a-fA-F]{6})$/);if(r){let[e,t,a]=r[1].split("");return"#".concat(e).concat(e).concat(t).concat(t).concat(a).concat(a).toLowerCase()}return a?"#".concat(a[1].toLowerCase()):""}(u.color),o=(u.icon||"").slice(0,32),i=Array.isArray(u.roleIds)?u.roleIds.map(String).filter(Boolean).slice(0,20):[],d={id:u.id||void 0,name:a,prefix:l,color:n,icon:o,roleIds:i};h(!0);try{await s.h.upsertTag(e,d),m(null),await E()}catch(e){r({type:"error",title:t("common.saveFailed")||"Falha ao guardar",description:(null==e?void 0:e.message)||"Erro desconhecido"})}finally{h(!1)}},I=async r=>{if(e&&confirm(t("tags.remove.confirm")||"Remover tag?")){h(!0);try{await s.h.deleteTag(e,r),await E()}finally{h(!1)}}},O=async t=>{if(N(t),y(!0),P(new Set),C(""),e)try{let t=await s.h.getMembers(e,{limit:50});S(t.members||t||[])}catch(e){S([])}},L=async()=>{if(e)try{let t=await s.h.getMembers(e,{q:w,limit:50,refresh:!0});S(t.members||t||[])}catch(e){S([])}},M=e=>P(t=>{let r=new Set(t);return r.has(e)?r.delete(e):r.add(e),r}),q=async()=>{if(e&&j&&0!==A.size){h(!0);try{let a=await s.h.applyTag(e,{tagId:j,userIds:Array.from(A),expireSeconds:"number"==typeof F?F:void 0});try{let e=Array.isArray(null==a?void 0:a.results)?a.results:[],l=e.filter(e=>null==e?void 0:e.ok).length,n=e.reduce((e,t)=>e+(Array.isArray(null==t?void 0:t.addedRoles)?t.addedRoles.length:(null==t?void 0:t.roleAdded)?1:0),0);r({type:"success",title:t("tags.apply.done")||"Tag applied",description:"".concat(l," ").concat(t("guild.members")||"members","; ").concat(n," ").concat(t("guild.roles")||"roles")})}catch(e){}y(!1),P(new Set)}catch(e){r({type:"error",title:t("common.saveFailed")||"Failed",description:null==e?void 0:e.message})}finally{h(!1)}}};return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"card p-4 flex flex-wrap items-end gap-3",children:[(0,a.jsxs)("div",{className:"md:w-64",children:[(0,a.jsx)("label",{className:"text-xs text-neutral-400",children:t("tags.search")||"Pesquisar"}),(0,a.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:p,onChange:e=>x(e.target.value),placeholder:t("tags.search.placeholder")||"Procurar por nome/prefixo"})]}),(0,a.jsx)("button",{type:"button",onClick:()=>m({id:"",name:"",prefix:"",color:"",icon:"",roleIds:[]}),className:"mt-5 px-3 py-2 rounded bg-brand-600 hover:bg-brand-700 disabled:opacity-50",children:t("tags.new")||"Nova tag"}),(0,a.jsx)("button",{type:"button",onClick:E,className:"mt-5 px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700 disabled:opacity-50",disabled:b,children:t("common.refresh")||"Atualizar"})]}),u&&(0,a.jsxs)("div",{className:"card p-4 grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-neutral-400",children:t("tags.name")||"Nome"}),(0,a.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:u.name,onChange:e=>m({...u,name:e.target.value}),placeholder:"Owner"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-neutral-400",children:t("tags.prefix")||"Prefixo"}),(0,a.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:u.prefix,onChange:e=>m({...u,prefix:e.target.value}),placeholder:"Owner | "})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-neutral-400",children:t("tags.color")||"Cor"}),(0,a.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:u.color||"",onChange:e=>m({...u,color:e.target.value}),placeholder:"#a855f7"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-neutral-400",children:t("tags.icon")||"\xcdcone"}),(0,a.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:u.icon||"",onChange:e=>m({...u,icon:e.target.value}),placeholder:"⭐"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"quicktag-roles",className:"text-xs text-neutral-400",children:t("tags.roles")||t("tags.role")||"Cargos (opcional)"}),(0,a.jsx)("select",{id:"quicktag-roles",title:t("tags.roles")||"Cargos (opcional)",multiple:!0,className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1 h-28",value:Array.isArray(u.roleIds)?u.roleIds:[],onChange:e=>{let t=Array.from(e.target.selectedOptions).map(e=>e.value).filter(Boolean);m(e=>({...e,roleIds:t}))},children:g.map(e=>(0,a.jsxs)("option",{value:e.id,disabled:!1===e.manageable,children:["@".concat(e.name),!1===e.manageable?" (n\xe3o gerenci\xe1vel)":""]},e.id))}),(0,a.jsx)("div",{className:"text-[11px] text-neutral-500 mt-1",children:t("tags.roles.hint")||"Note: roles at/above the bot’s highest role or managed roles are skipped automatically."})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:R,className:"mt-5 px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700 disabled:opacity-50",disabled:b,children:t("common.save")||"Guardar"}),(0,a.jsx)("button",{type:"button",onClick:()=>m(null),className:"mt-5 px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",children:t("common.cancel")||"Cancelar"})]})]}),(0,a.jsx)("div",{className:"card p-0 overflow-hidden",children:(0,a.jsxs)("div",{className:"divide-y divide-neutral-800",children:[b&&(0,a.jsx)("div",{className:"p-6 text-neutral-400",children:t("common.loading")||"A carregar…"}),_.map(e=>(0,a.jsxs)("div",{className:"p-4 flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-6 w-6 rounded bg-neutral-800 border border-neutral-700 flex items-center justify-center",title:e.icon||"",children:e.icon||"\uD83C\uDFF7️"}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsxs)("div",{className:"text-neutral-200 truncate",children:[e.name," ",(0,a.jsxs)("span",{className:"text-neutral-500",children:["(",e.prefix,")"]})]})}),(0,a.jsx)("button",{type:"button",className:"px-2 py-1 text-xs rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",onClick:()=>m(e),title:"Editar",children:t("common.edit")||"Editar"}),(0,a.jsx)("button",{type:"button",className:"px-2 py-1 text-xs rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",onClick:()=>O(e.id),title:"Aplicar",children:t("tags.apply")||"Aplicar"}),(0,a.jsx)("button",{type:"button",className:"px-2 py-1 text-xs rounded bg-rose-600 hover:bg-rose-500",onClick:()=>I(e.id),title:"Remover",children:t("common.remove")||"Remover"})]},e.id))]})}),v&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",role:"dialog","aria-modal":!0,children:(0,a.jsxs)("div",{className:"bg-neutral-900 border border-neutral-700 rounded-xl w-full max-w-3xl p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-lg font-semibold",children:t("tags.apply.modalTitle")||"Aplicar tag"}),(0,a.jsx)("button",{type:"button",onClick:()=>y(!1),className:"px-2 py-1 text-xs rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",children:t("common.close")||"Fechar"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 items-end",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"text-xs text-neutral-400",children:t("tags.members.search")||"Pesquisar membros"}),(0,a.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:w,onChange:e=>C(e.target.value),placeholder:"nome ou id"})]}),(0,a.jsx)("button",{type:"button",onClick:L,className:"mt-5 px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",children:t("common.search")||"Pesquisar"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-xs text-neutral-400",children:t("tags.expireSeconds")||"Expira\xe7\xe3o (segundos, opcional)"}),(0,a.jsx)("input",{type:"number",className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:F,onChange:e=>T(e.target.value?parseInt(e.target.value,10):""),placeholder:"3600"})]})]}),(0,a.jsx)("div",{className:"h-64 overflow-auto border border-neutral-800 rounded",children:k.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-3 p-2 border-b border-neutral-800",children:[(0,a.jsx)("input",{type:"checkbox",checked:A.has(e.id),onChange:()=>M(e.id)}),(0,a.jsx)("span",{className:"flex-1 min-w-0 text-neutral-200 truncate",children:e.nick?"".concat(e.nick," (").concat(e.username,"#").concat(e.discriminator,")"):"".concat(e.username,"#").concat(e.discriminator)}),(0,a.jsx)("span",{className:"text-xs text-neutral-500",children:e.id})]},e.id))}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:q,className:"px-3 py-2 rounded bg-brand-600 hover:bg-brand-700 disabled:opacity-50",disabled:0===A.size,children:t("tags.applyNow")||"Aplicar agora"}),(0,a.jsx)("button",{type:"button",onClick:()=>y(!1),className:"px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",children:t("common.cancel")||"Cancelar"})]})]})})]})}},8183:function(e,t,r){"use strict";r.d(t,{ToasterProvider:function(){return o},p:function(){return s}});var a=r(7437),l=r(2265);let n=(0,l.createContext)(null);function s(){let e=(0,l.useContext)(n);if(!e)throw Error("useToast must be used within <ToasterProvider />");return e}function o(e){let{children:t}=e,[r,s]=(0,l.useState)([]),o=(0,l.useRef)(0),i=(0,l.useCallback)(e=>{s(t=>t.filter(t=>t.id!==e))},[]),d=(0,l.useCallback)(e=>{let t="".concat(Date.now(),"_").concat(o.current++),r={id:t,...e};s(e=>[...e,r]),window.setTimeout(()=>i(t),4500)},[i]),c=(0,l.useMemo)(()=>({toast:d}),[d]);return(0,a.jsxs)(n.Provider,{value:c,children:[t,(0,a.jsx)("div",{className:"fixed z-50 right-4 bottom-4 flex flex-col gap-2 w-[min(92vw,380px)]",role:"status","aria-live":"polite",children:r.map(e=>(0,a.jsxs)("div",{className:"rounded-xl border p-3 shadow-lg backdrop-blur card ".concat("success"===e.type?"border-emerald-700/60":"error"===e.type?"border-rose-700/60":"border-neutral-700/60"),children:[e.title&&(0,a.jsx)("div",{className:"text-sm font-semibold mb-0.5",children:e.title}),e.description&&(0,a.jsx)("div",{className:"text-xs text-neutral-300",children:e.description})]},e.id))})]})}},912:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let a=r(5592);function l(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new a.BailoutToCSRError(t);return r}},1481:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return n}});let a=r(7437),l=r(8512);function n(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=(0,l.getExpectedRequestStore)("next/dynamic css"),n=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files.filter(e=>e.endsWith(".css"));n.push(...t)}}return 0===n.length?null:(0,a.jsx)(a.Fragment,{children:n.map(e=>(0,a.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:r.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[814,482,971,23,744],function(){return e(e.s=2176)}),_N_E=e.O()}]);