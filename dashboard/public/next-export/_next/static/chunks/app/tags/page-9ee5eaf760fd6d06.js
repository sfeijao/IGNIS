(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[904],{2176:function(e,r,a){Promise.resolve().then(a.bind(a,7960)),Promise.resolve().then(a.bind(a,912)),Promise.resolve().then(a.bind(a,1481))},7960:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return d}});var t=a(7437),l=a(2265),s=a(2837),n=a(9988),o=a(7814),i=a(8183);function d(){let e=(0,s._)(),{t:r}=(0,o.QT)(),{toast:a}=(0,i.p)(),[d,c]=(0,l.useState)([]),[u,m]=(0,l.useState)(null),[x,p]=(0,l.useState)(""),[b,h]=(0,l.useState)(!1),[g,f]=(0,l.useState)([]),[v,y]=(0,l.useState)(!1),[j,N]=(0,l.useState)(""),[w,C]=(0,l.useState)(""),[k,S]=(0,l.useState)([]),[P,A]=(0,l.useState)(new Set),[T,_]=(0,l.useState)(""),R=(0,l.useMemo)(()=>d.filter(e=>!x||e.name.toLowerCase().includes(x.toLowerCase())||e.prefix.toLowerCase().includes(x.toLowerCase())),[d,x]),E=async()=>{if(e){h(!0);try{let r=await n.h.getTags(e);c(r.tags||[]);try{let r=await n.h.getRoles(e),a=(r.roles||r||[]).map(e=>({id:e.id,name:e.name,manageable:e.manageable}));f(a)}catch(e){f([])}}finally{h(!1)}}};(0,l.useEffect)(()=>{E()},[e]);let O=async()=>{if(e&&u&&u.name&&u.prefix){h(!0);try{await n.h.upsertTag(e,u),m(null),await E()}finally{h(!1)}}},I=async a=>{if(e&&confirm(r("tags.remove.confirm")||"Remover tag?")){h(!0);try{await n.h.deleteTag(e,a),await E()}finally{h(!1)}}},M=async r=>{if(N(r),y(!0),A(new Set),C(""),e)try{let r=await n.h.getMembers(e,{limit:50});S(r.members||r||[])}catch(e){S([])}},q=async()=>{if(e)try{let r=await n.h.getMembers(e,{q:w,limit:50,refresh:!0});S(r.members||r||[])}catch(e){S([])}},F=e=>A(r=>{let a=new Set(r);return a.has(e)?a.delete(e):a.add(e),a}),L=async()=>{if(e&&j&&0!==P.size){h(!0);try{let t=await n.h.applyTag(e,{tagId:j,userIds:Array.from(P),expireSeconds:"number"==typeof T?T:void 0});try{let e=Array.isArray(null==t?void 0:t.results)?t.results:[],l=e.filter(e=>null==e?void 0:e.ok).length,s=e.reduce((e,r)=>e+(Array.isArray(null==r?void 0:r.addedRoles)?r.addedRoles.length:(null==r?void 0:r.roleAdded)?1:0),0);a({type:"success",title:r("tags.apply.done")||"Tag applied",description:"".concat(l," ").concat(r("guild.members")||"members","; ").concat(s," ").concat(r("guild.roles")||"roles")})}catch(e){}y(!1),A(new Set)}catch(e){a({type:"error",title:r("common.saveFailed")||"Failed",description:null==e?void 0:e.message})}finally{h(!1)}}};return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"card p-4 flex flex-wrap items-end gap-3",children:[(0,t.jsxs)("div",{className:"md:w-64",children:[(0,t.jsx)("label",{className:"text-xs text-neutral-400",children:r("tags.search")||"Pesquisar"}),(0,t.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:x,onChange:e=>p(e.target.value),placeholder:r("tags.search.placeholder")||"Procurar por nome/prefixo"})]}),(0,t.jsx)("button",{onClick:()=>m({id:"",name:"",prefix:"",color:"",icon:"",roleIds:[]}),className:"mt-5 px-3 py-2 rounded bg-brand-600 hover:bg-brand-700 disabled:opacity-50",children:r("tags.new")||"Nova tag"}),(0,t.jsx)("button",{onClick:E,className:"mt-5 px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700 disabled:opacity-50",disabled:b,children:r("common.refresh")||"Atualizar"})]}),u&&(0,t.jsxs)("div",{className:"card p-4 grid grid-cols-1 md:grid-cols-6 gap-3 items-end",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-neutral-400",children:r("tags.name")||"Nome"}),(0,t.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:u.name,onChange:e=>m({...u,name:e.target.value}),placeholder:"Owner"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-neutral-400",children:r("tags.prefix")||"Prefixo"}),(0,t.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:u.prefix,onChange:e=>m({...u,prefix:e.target.value}),placeholder:"Owner | "})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-neutral-400",children:r("tags.color")||"Cor"}),(0,t.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:u.color||"",onChange:e=>m({...u,color:e.target.value}),placeholder:"#a855f7"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-neutral-400",children:r("tags.icon")||"\xcdcone"}),(0,t.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:u.icon||"",onChange:e=>m({...u,icon:e.target.value}),placeholder:"⭐"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"quicktag-roles",className:"text-xs text-neutral-400",children:r("tags.roles")||r("tags.role")||"Cargos (opcional)"}),(0,t.jsx)("select",{id:"quicktag-roles",title:r("tags.roles")||"Cargos (opcional)",multiple:!0,className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1 h-28",value:Array.isArray(u.roleIds)?u.roleIds:[],onChange:e=>{let r=Array.from(e.target.selectedOptions).map(e=>e.value).filter(Boolean);m(e=>({...e,roleIds:r}))},children:g.map(e=>(0,t.jsxs)("option",{value:e.id,disabled:!1===e.manageable,children:["@".concat(e.name),!1===e.manageable?" (n\xe3o gerenci\xe1vel)":""]},e.id))}),(0,t.jsx)("div",{className:"text-[11px] text-neutral-500 mt-1",children:r("tags.roles.hint")||"Note: roles at/above the bot’s highest role or managed roles are skipped automatically."})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:O,className:"mt-5 px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700 disabled:opacity-50",disabled:b,children:r("common.save")||"Guardar"}),(0,t.jsx)("button",{onClick:()=>m(null),className:"mt-5 px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",children:r("common.cancel")||"Cancelar"})]})]}),(0,t.jsx)("div",{className:"card p-0 overflow-hidden",children:(0,t.jsxs)("div",{className:"divide-y divide-neutral-800",children:[b&&(0,t.jsx)("div",{className:"p-6 text-neutral-400",children:r("common.loading")||"A carregar…"}),R.map(e=>(0,t.jsxs)("div",{className:"p-4 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-6 w-6 rounded bg-neutral-800 border border-neutral-700 flex items-center justify-center",title:e.icon||"",children:e.icon||"\uD83C\uDFF7️"}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsxs)("div",{className:"text-neutral-200 truncate",children:[e.name," ",(0,t.jsxs)("span",{className:"text-neutral-500",children:["(",e.prefix,")"]})]})}),(0,t.jsx)("button",{className:"px-2 py-1 text-xs rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",onClick:()=>m(e),title:"Editar",children:r("common.edit")||"Editar"}),(0,t.jsx)("button",{className:"px-2 py-1 text-xs rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",onClick:()=>M(e.id),title:"Aplicar",children:r("tags.apply")||"Aplicar"}),(0,t.jsx)("button",{className:"px-2 py-1 text-xs rounded bg-rose-600 hover:bg-rose-500",onClick:()=>I(e.id),title:"Remover",children:r("common.remove")||"Remover"})]},e.id))]})}),v&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 p-4",role:"dialog","aria-modal":!0,children:(0,t.jsxs)("div",{className:"bg-neutral-900 border border-neutral-700 rounded-xl w-full max-w-3xl p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("div",{className:"text-lg font-semibold",children:r("tags.apply.modalTitle")||"Aplicar tag"}),(0,t.jsx)("button",{onClick:()=>y(!1),className:"px-2 py-1 text-xs rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",children:r("common.close")||"Fechar"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 items-end",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"text-xs text-neutral-400",children:r("tags.members.search")||"Pesquisar membros"}),(0,t.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:w,onChange:e=>C(e.target.value),placeholder:"nome ou id"})]}),(0,t.jsx)("button",{onClick:q,className:"mt-5 px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",children:r("common.search")||"Pesquisar"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-xs text-neutral-400",children:r("tags.expireSeconds")||"Expira\xe7\xe3o (segundos, opcional)"}),(0,t.jsx)("input",{type:"number",className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:T,onChange:e=>_(e.target.value?parseInt(e.target.value,10):""),placeholder:"3600"})]})]}),(0,t.jsx)("div",{className:"h-64 overflow-auto border border-neutral-800 rounded",children:k.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-3 p-2 border-b border-neutral-800",children:[(0,t.jsx)("input",{type:"checkbox",checked:P.has(e.id),onChange:()=>F(e.id)}),(0,t.jsx)("span",{className:"flex-1 min-w-0 text-neutral-200 truncate",children:e.nick?"".concat(e.nick," (").concat(e.username,"#").concat(e.discriminator,")"):"".concat(e.username,"#").concat(e.discriminator)}),(0,t.jsx)("span",{className:"text-xs text-neutral-500",children:e.id})]},e.id))}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:L,className:"px-3 py-2 rounded bg-brand-600 hover:bg-brand-700 disabled:opacity-50",disabled:0===P.size,children:r("tags.applyNow")||"Aplicar agora"}),(0,t.jsx)("button",{onClick:()=>y(!1),className:"px-3 py-2 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700",children:r("common.cancel")||"Cancelar"})]})]})})]})}},8183:function(e,r,a){"use strict";a.d(r,{ToasterProvider:function(){return o},p:function(){return n}});var t=a(7437),l=a(2265);let s=(0,l.createContext)(null);function n(){let e=(0,l.useContext)(s);if(!e)throw Error("useToast must be used within <ToasterProvider />");return e}function o(e){let{children:r}=e,[a,n]=(0,l.useState)([]),o=(0,l.useRef)(0),i=(0,l.useCallback)(e=>{n(r=>r.filter(r=>r.id!==e))},[]),d=(0,l.useCallback)(e=>{let r="".concat(Date.now(),"_").concat(o.current++),a={id:r,...e};n(e=>[...e,a]),window.setTimeout(()=>i(r),4500)},[i]),c=(0,l.useMemo)(()=>({toast:d}),[d]);return(0,t.jsxs)(s.Provider,{value:c,children:[r,(0,t.jsx)("div",{className:"fixed z-50 right-4 bottom-4 flex flex-col gap-2 w-[min(92vw,380px)]",role:"status","aria-live":"polite",children:a.map(e=>(0,t.jsxs)("div",{className:"rounded-xl border p-3 shadow-lg backdrop-blur card ".concat("success"===e.type?"border-emerald-700/60":"error"===e.type?"border-rose-700/60":"border-neutral-700/60"),children:[e.title&&(0,t.jsx)("div",{className:"text-sm font-semibold mb-0.5",children:e.title}),e.description&&(0,t.jsx)("div",{className:"text-xs text-neutral-300",children:e.description})]},e.id))})]})}},912:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let t=a(5592);function l(e){let{reason:r,children:a}=e;if("undefined"==typeof window)throw new t.BailoutToCSRError(r);return a}},1481:function(e,r,a){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"PreloadCss",{enumerable:!0,get:function(){return s}});let t=a(7437),l=a(8512);function s(e){let{moduleIds:r}=e;if("undefined"!=typeof window)return null;let a=(0,l.getExpectedRequestStore)("next/dynamic css"),s=[];if(a.reactLoadableManifest&&r){let e=a.reactLoadableManifest;for(let a of r){if(!e[a])continue;let r=e[a].files.filter(e=>e.endsWith(".css"));s.push(...r)}}return 0===s.length?null:(0,t.jsx)(t.Fragment,{children:s.map(e=>(0,t.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[814,482,971,23,744],function(){return e(e.s=2176)}),_N_E=e.O()}]);