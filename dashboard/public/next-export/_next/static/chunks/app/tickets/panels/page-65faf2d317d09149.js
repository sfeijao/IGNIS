(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{6e3:function(e,t,a){Promise.resolve().then(a.bind(a,4051))},4051:function(e,t,a){"use strict";a.d(t,{default:function(){return u}});var s=a(7437),n=a(2265),l=a(2837),c=a(9988),i=a(8183),r=a(7814);let d=e=>{var t;let a=(null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"").toString().toLowerCase();return""===a||"0"===a||"text"===a||"guild_text"===a||"5"===a||"announcement"===a||"guild_announcement"===a},o=e=>{var t;let a=(null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"").toString().toLowerCase();return"0"===a||"text"===a||"guild_text"===a?"Text":"2"===a||"voice"===a||"guild_voice"===a?"Voice":"4"===a||"category"===a||"guild_category"===a?"Category":"5"===a||"announcement"===a||"guild_announcement"===a?"Announcement":"Channel"};function u(){let[e,t]=(0,n.useState)(null),[a,u]=(0,n.useState)([]),[m,h]=(0,n.useState)([]),[p,x]=(0,n.useState)([]),[y,g]=(0,n.useState)(!1),[b,v]=(0,n.useState)(null),{toast:N}=(0,i.p)(),{t:f}=(0,r.QT)(),[j,k]=(0,n.useState)({name:"",channelId:""}),[C,w]=(0,n.useState)({name:""});(0,n.useEffect)(()=>{t((0,l._)())},[]);let _=async e=>{g(!0),v(null);try{let[t,a,s]=await Promise.all([c.h.getPanels(e),c.h.getCategories(e),c.h.getChannels(e)]);u((null==t?void 0:t.panels)||t||[]),h((null==a?void 0:a.categories)||a||[]),x(((null==s?void 0:s.channels)||s||[]).filter(e=>e&&e.id&&e.name))}catch(e){v((null==e?void 0:e.message)||"Erro ao carregar")}finally{g(!1)}};(0,n.useEffect)(()=>{e&&_(e)},[e]);let S=async()=>{if(e){g(!0);try{await c.h.scanPanels(e),N({type:"success",title:f("tickets.scan.done")})}catch(e){N({type:"error",title:f("tickets.scan.fail"),description:null==e?void 0:e.message})}await _(e)}},I=async t=>{if(t.preventDefault(),e&&j.name&&j.channelId){g(!0);try{await c.h.createPanel(e,j),N({type:"success",title:f("tickets.panel.created")}),k({name:"",channelId:""}),await _(e)}catch(e){N({type:"error",title:f("tickets.panel.createFail"),description:null==e?void 0:e.message})}finally{g(!1)}}},P=async t=>{if(t.preventDefault(),e&&C.name){g(!0);try{await c.h.createCategory(e,C),N({type:"success",title:f("tickets.category.created")}),w({name:""}),await _(e)}catch(e){N({type:"error",title:f("tickets.category.createFail"),description:null==e?void 0:e.message})}finally{g(!1)}}},E=(0,n.useMemo)(()=>a.map(e=>{let t=p.find(t=>t.id===e.channelId),a=m.find(t=>t.id===e.categoryId),s=t?"#".concat(t.name," (").concat(o(t),")"):"-";return{...e,channelName:s,categoryName:(null==a?void 0:a.name)||"-"}}),[a,p,m]);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:f("tickets.panels.title")}),(0,s.jsx)("button",{onClick:()=>e&&_(e),className:"btn btn-secondary",title:f("tickets.reload"),children:f("tickets.reload")}),(0,s.jsx)("button",{onClick:S,className:"btn btn-primary",title:f("tickets.scan"),children:f("tickets.scan")})]}),b&&(0,s.jsx)("div",{className:"text-red-400",children:b}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:f("tickets.panel.create")}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("form",{onSubmit:I,className:"flex flex-col gap-3",children:[(0,s.jsx)("input",{value:j.name,onChange:e=>k(t=>({...t,name:e.target.value})),placeholder:f("tickets.panels.panelName.placeholder"),className:"input",required:!0}),(0,s.jsxs)("select",{value:j.channelId,onChange:e=>k(t=>({...t,channelId:e.target.value})),className:"input",required:!0,title:"Canal do painel",children:[(0,s.jsx)("option",{value:"",children:f("tickets.panels.selectChannel")}),p.filter(d).map(e=>(0,s.jsx)("option",{value:e.id,children:"#".concat(e.name," (").concat(o(e),")")},e.id))]}),(0,s.jsxs)("select",{value:j.categoryId||"",onChange:e=>k(t=>({...t,categoryId:e.target.value||void 0})),className:"input",title:"Categoria opcional",children:[(0,s.jsx)("option",{value:"",children:f("tickets.panels.noCategory")}),m.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsx)("button",{className:"btn btn-primary",disabled:y,children:f("tickets.panel.create")})]})})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:f("tickets.category.create")}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("form",{onSubmit:P,className:"flex flex-col gap-3",children:[(0,s.jsx)("input",{value:C.name,onChange:e=>w({name:e.target.value}),placeholder:f("tickets.panels.categoryName.placeholder"),className:"input",required:!0}),(0,s.jsx)("button",{className:"btn btn-primary",disabled:y,children:f("tickets.category.create")})]})})]})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:f("tickets.panels.list")}),(0,s.jsx)("div",{className:"card-body overflow-auto",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[(0,s.jsx)("thead",{className:"text-left",children:(0,s.jsxs)("tr",{className:"border-b border-neutral-800",children:[(0,s.jsx)("th",{className:"py-2 pr-4",children:f("tickets.table.name")}),(0,s.jsx)("th",{className:"py-2 pr-4",children:f("tickets.table.channel")}),(0,s.jsx)("th",{className:"py-2 pr-4",children:f("tickets.table.category")}),(0,s.jsx)("th",{className:"py-2 pr-4",children:f("tickets.table.message")}),(0,s.jsx)("th",{className:"py-2",children:f("tickets.table.actions")})]})}),(0,s.jsx)("tbody",{children:E.map(t=>(0,s.jsxs)("tr",{className:"border-b border-neutral-900/50",children:[(0,s.jsx)("td",{className:"py-2 pr-4",children:t.name}),(0,s.jsx)("td",{className:"py-2 pr-4",children:t.channelName}),(0,s.jsx)("td",{className:"py-2 pr-4",children:t.categoryName}),(0,s.jsx)("td",{className:"py-2 pr-4",children:t.messageId||"-"}),(0,s.jsxs)("td",{className:"py-2 flex gap-2",children:[(0,s.jsx)("button",{className:"btn btn-secondary btn-xs",title:f("tickets.action.sync"),onClick:()=>e&&c.h.panelAction(e,t.id,"sync").then(()=>{N({type:"success",title:f("tickets.synced")}),_(e)}).catch(e=>N({type:"error",title:"Falha",description:null==e?void 0:e.message})),children:f("tickets.action.sync")}),(0,s.jsx)("button",{className:"btn btn-secondary btn-xs",title:f("tickets.action.messageUpdate"),onClick:()=>e&&c.h.panelAction(e,t.id,"refresh_message").then(()=>{N({type:"success",title:f("tickets.action.messageUpdate")}),_(e)}).catch(e=>N({type:"error",title:"Falha",description:null==e?void 0:e.message})),children:f("tickets.action.messageUpdate")}),(0,s.jsx)("button",{className:"btn btn-danger btn-xs",title:f("tickets.action.delete"),onClick:()=>e&&c.h.panelAction(e,t.id,"delete").then(()=>{N({type:"success",title:f("tickets.removed")}),_(e)}).catch(e=>N({type:"error",title:"Falha",description:null==e?void 0:e.message})),children:f("tickets.action.delete")})]})]},t.id))})]})})]})]})}},8183:function(e,t,a){"use strict";a.d(t,{ToasterProvider:function(){return i},p:function(){return c}});var s=a(7437),n=a(2265);let l=(0,n.createContext)(null);function c(){let e=(0,n.useContext)(l);if(!e)throw Error("useToast must be used within <ToasterProvider />");return e}function i(e){let{children:t}=e,[a,c]=(0,n.useState)([]),i=(0,n.useRef)(0),r=(0,n.useCallback)(e=>{c(t=>t.filter(t=>t.id!==e))},[]),d=(0,n.useCallback)(e=>{let t="".concat(Date.now(),"_").concat(i.current++),a={id:t,...e};c(e=>[...e,a]),window.setTimeout(()=>r(t),4500)},[r]),o=(0,n.useMemo)(()=>({toast:d}),[d]);return(0,s.jsxs)(l.Provider,{value:o,children:[t,(0,s.jsx)("div",{className:"fixed z-50 right-4 bottom-4 flex flex-col gap-2 w-[min(92vw,380px)]",role:"status","aria-live":"polite",children:a.map(e=>(0,s.jsxs)("div",{className:"rounded-xl border p-3 shadow-lg backdrop-blur card ".concat("success"===e.type?"border-emerald-700/60":"error"===e.type?"border-rose-700/60":"border-neutral-700/60"),children:[e.title&&(0,s.jsx)("div",{className:"text-sm font-semibold mb-0.5",children:e.title}),e.description&&(0,s.jsx)("div",{className:"text-xs text-neutral-300",children:e.description})]},e.id))})]})}}},function(e){e.O(0,[814,482,971,23,744],function(){return e(e.s=6e3)}),_N_E=e.O()}]);