(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{6e3:function(e,t,a){Promise.resolve().then(a.bind(a,4051))},4051:function(e,t,a){"use strict";a.d(t,{default:function(){return d}});var s=a(7437),l=a(2265),c=a(2837),n=a(9988),i=a(8183),r=a(7814);function d(){let[e,t]=(0,l.useState)(null),[a,d]=(0,l.useState)([]),[o,u]=(0,l.useState)([]),[h,m]=(0,l.useState)([]),[p,x]=(0,l.useState)(!1),[y,b]=(0,l.useState)(null),{toast:g}=(0,i.p)(),{t:N}=(0,r.QT)(),[v,j]=(0,l.useState)({name:"",channelId:""}),[f,k]=(0,l.useState)({name:""});(0,l.useEffect)(()=>{t((0,c._)())},[]);let C=async e=>{x(!0),b(null);try{let[t,a,s]=await Promise.all([n.h.getPanels(e),n.h.getCategories(e),n.h.getChannels(e)]);d((null==t?void 0:t.panels)||t||[]),u((null==a?void 0:a.categories)||a||[]),m(((null==s?void 0:s.channels)||s||[]).filter(e=>e&&e.id&&e.name))}catch(e){b((null==e?void 0:e.message)||"Erro ao carregar")}finally{x(!1)}};(0,l.useEffect)(()=>{e&&C(e)},[e]);let w=async()=>{if(e){x(!0);try{await n.h.scanPanels(e),g({type:"success",title:N("tickets.scan.done")})}catch(e){g({type:"error",title:N("tickets.scan.fail"),description:null==e?void 0:e.message})}await C(e)}},S=async t=>{if(t.preventDefault(),e&&v.name&&v.channelId){x(!0);try{await n.h.createPanel(e,v),g({type:"success",title:N("tickets.panel.created")}),j({name:"",channelId:""}),await C(e)}catch(e){g({type:"error",title:N("tickets.panel.createFail"),description:null==e?void 0:e.message})}finally{x(!1)}}},I=async t=>{if(t.preventDefault(),e&&f.name){x(!0);try{await n.h.createCategory(e,f),g({type:"success",title:N("tickets.category.created")}),k({name:""}),await C(e)}catch(e){g({type:"error",title:N("tickets.category.createFail"),description:null==e?void 0:e.message})}finally{x(!1)}}},_=(0,l.useMemo)(()=>a.map(e=>{let t=h.find(t=>t.id===e.channelId),a=o.find(t=>t.id===e.categoryId);return{...e,channelName:(null==t?void 0:t.name)||"-",categoryName:(null==a?void 0:a.name)||"-"}}),[a,h,o]);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:N("tickets.panels.title")}),(0,s.jsx)("button",{onClick:()=>e&&C(e),className:"btn btn-secondary",title:N("tickets.reload"),children:N("tickets.reload")}),(0,s.jsx)("button",{onClick:w,className:"btn btn-primary",title:N("tickets.scan"),children:N("tickets.scan")})]}),y&&(0,s.jsx)("div",{className:"text-red-400",children:y}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:N("tickets.panel.create")}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("form",{onSubmit:S,className:"flex flex-col gap-3",children:[(0,s.jsx)("input",{value:v.name,onChange:e=>j(t=>({...t,name:e.target.value})),placeholder:N("tickets.panels.panelName.placeholder"),className:"input",required:!0}),(0,s.jsxs)("select",{value:v.channelId,onChange:e=>j(t=>({...t,channelId:e.target.value})),className:"input",required:!0,title:"Canal do painel",children:[(0,s.jsx)("option",{value:"",children:N("tickets.panels.selectChannel")}),h.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsxs)("select",{value:v.categoryId||"",onChange:e=>j(t=>({...t,categoryId:e.target.value||void 0})),className:"input",title:"Categoria opcional",children:[(0,s.jsx)("option",{value:"",children:N("tickets.panels.noCategory")}),o.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsx)("button",{className:"btn btn-primary",disabled:p,children:N("tickets.panel.create")})]})})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:N("tickets.category.create")}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("form",{onSubmit:I,className:"flex flex-col gap-3",children:[(0,s.jsx)("input",{value:f.name,onChange:e=>k({name:e.target.value}),placeholder:N("tickets.panels.categoryName.placeholder"),className:"input",required:!0}),(0,s.jsx)("button",{className:"btn btn-primary",disabled:p,children:N("tickets.category.create")})]})})]})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:N("tickets.panels.list")}),(0,s.jsx)("div",{className:"card-body overflow-auto",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[(0,s.jsx)("thead",{className:"text-left",children:(0,s.jsxs)("tr",{className:"border-b border-neutral-800",children:[(0,s.jsx)("th",{className:"py-2 pr-4",children:N("tickets.table.name")}),(0,s.jsx)("th",{className:"py-2 pr-4",children:N("tickets.table.channel")}),(0,s.jsx)("th",{className:"py-2 pr-4",children:N("tickets.table.category")}),(0,s.jsx)("th",{className:"py-2 pr-4",children:N("tickets.table.message")}),(0,s.jsx)("th",{className:"py-2",children:N("tickets.table.actions")})]})}),(0,s.jsx)("tbody",{children:_.map(t=>(0,s.jsxs)("tr",{className:"border-b border-neutral-900/50",children:[(0,s.jsx)("td",{className:"py-2 pr-4",children:t.name}),(0,s.jsx)("td",{className:"py-2 pr-4",children:t.channelName}),(0,s.jsx)("td",{className:"py-2 pr-4",children:t.categoryName}),(0,s.jsx)("td",{className:"py-2 pr-4",children:t.messageId||"-"}),(0,s.jsxs)("td",{className:"py-2 flex gap-2",children:[(0,s.jsx)("button",{className:"btn btn-secondary btn-xs",title:N("tickets.action.sync"),onClick:()=>e&&n.h.panelAction(e,t.id,"sync").then(()=>{g({type:"success",title:N("tickets.synced")}),C(e)}).catch(e=>g({type:"error",title:"Falha",description:null==e?void 0:e.message})),children:N("tickets.action.sync")}),(0,s.jsx)("button",{className:"btn btn-secondary btn-xs",title:N("tickets.action.messageUpdate"),onClick:()=>e&&n.h.panelAction(e,t.id,"refresh_message").then(()=>{g({type:"success",title:N("tickets.action.messageUpdate")}),C(e)}).catch(e=>g({type:"error",title:"Falha",description:null==e?void 0:e.message})),children:N("tickets.action.messageUpdate")}),(0,s.jsx)("button",{className:"btn btn-danger btn-xs",title:N("tickets.action.delete"),onClick:()=>e&&n.h.panelAction(e,t.id,"delete").then(()=>{g({type:"success",title:N("tickets.removed")}),C(e)}).catch(e=>g({type:"error",title:"Falha",description:null==e?void 0:e.message})),children:N("tickets.action.delete")})]})]},t.id))})]})})]})]})}},8183:function(e,t,a){"use strict";a.d(t,{ToasterProvider:function(){return i},p:function(){return n}});var s=a(7437),l=a(2265);let c=(0,l.createContext)(null);function n(){let e=(0,l.useContext)(c);if(!e)throw Error("useToast must be used within <ToasterProvider />");return e}function i(e){let{children:t}=e,[a,n]=(0,l.useState)([]),i=(0,l.useRef)(0),r=(0,l.useCallback)(e=>{n(t=>t.filter(t=>t.id!==e))},[]),d=(0,l.useCallback)(e=>{let t="".concat(Date.now(),"_").concat(i.current++),a={id:t,...e};n(e=>[...e,a]),window.setTimeout(()=>r(t),4500)},[r]),o=(0,l.useMemo)(()=>({toast:d}),[d]);return(0,s.jsxs)(c.Provider,{value:o,children:[t,(0,s.jsx)("div",{className:"fixed z-50 right-4 bottom-4 flex flex-col gap-2 w-[min(92vw,380px)]",role:"status","aria-live":"polite",children:a.map(e=>(0,s.jsxs)("div",{className:"rounded-xl border p-3 shadow-lg backdrop-blur card ".concat("success"===e.type?"border-emerald-700/60":"error"===e.type?"border-rose-700/60":"border-neutral-700/60"),children:[e.title&&(0,s.jsx)("div",{className:"text-sm font-semibold mb-0.5",children:e.title}),e.description&&(0,s.jsx)("div",{className:"text-xs text-neutral-300",children:e.description})]},e.id))})]})}}},function(e){e.O(0,[814,482,971,23,744],function(){return e(e.s=6e3)}),_N_E=e.O()}]);