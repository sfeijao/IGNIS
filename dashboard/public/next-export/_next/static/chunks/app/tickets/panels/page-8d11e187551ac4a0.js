(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{6e3:function(e,t,a){Promise.resolve().then(a.bind(a,4051))},4051:function(e,t,a){"use strict";a.d(t,{default:function(){return u}});var s=a(7437),n=a(2265),c=a(2837),l=a(9988),i=a(8183),r=a(7814);let o=e=>{var t;let a=(null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"").toString().toLowerCase();return""===a||"0"===a||"text"===a||"guild_text"===a||"5"===a||"announcement"===a||"guild_announcement"===a},d=e=>{var t;let a=(null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"").toString().toLowerCase();return"0"===a||"text"===a||"guild_text"===a?"Text":"2"===a||"voice"===a||"guild_voice"===a?"Voice":"4"===a||"category"===a||"guild_category"===a?"Category":"5"===a||"announcement"===a||"guild_announcement"===a?"Announcement":"Channel"};function u(){let[e,t]=(0,n.useState)(null),[a,u]=(0,n.useState)([]),[m,h]=(0,n.useState)([]),[p,x]=(0,n.useState)([]),[b,y]=(0,n.useState)(!1),[g,v]=(0,n.useState)(null),{toast:j}=(0,i.p)(),{t:k}=(0,r.QT)(),[f,N]=(0,n.useState)({name:"",channelId:""}),[C,w]=(0,n.useState)({name:""}),[_,S]=(0,n.useState)("");(0,n.useEffect)(()=>{t((0,c._)())},[]);let F=async e=>{y(!0),v(null);try{let[t,a,s]=await Promise.all([l.h.getPanels(e),l.h.getCategories(e),l.h.getChannels(e)]);u((null==t?void 0:t.panels)||t||[]),h((null==a?void 0:a.categories)||a||[]),x(((null==s?void 0:s.channels)||s||[]).filter(e=>e&&e.id&&e.name))}catch(e){v((null==e?void 0:e.message)||"Erro ao carregar")}finally{y(!1)}};(0,n.useEffect)(()=>{e&&F(e)},[e]);let P=async()=>{if(e){y(!0);try{await l.h.scanPanels(e),j({type:"success",title:k("tickets.scan.done")})}catch(e){j({type:"error",title:k("tickets.scan.fail"),description:null==e?void 0:e.message})}await F(e)}},A=async t=>{if(t.preventDefault(),e&&f.name&&f.channelId){y(!0);try{await l.h.createPanel(e,f),j({type:"success",title:k("tickets.panel.created")}),N({name:"",channelId:""}),await F(e)}catch(e){j({type:"error",title:k("tickets.panel.createFail"),description:null==e?void 0:e.message})}finally{y(!1)}}},E=async t=>{if(t.preventDefault(),e&&C.name){y(!0);try{await l.h.createCategory(e,C),w({name:""}),await F(e)}catch(e){j({type:"error",title:k("tickets.category.createFail"),description:null==e?void 0:e.message})}finally{y(!1)}}},I=(0,n.useMemo)(()=>{let e=(_||"").toLowerCase();return a.map(e=>{let t=p.find(t=>t.id===e.channel_id),a=e.channelName||(t?"#".concat(t.name," (").concat(d(t),")"):"-");return{...e,channelLabel:a}}).filter(t=>{if(!e)return!0;let a=t.name||"",s=t.channelLabel||"";return String(a).toLowerCase().includes(e)||String(s).toLowerCase().includes(e)})},[a,p,_]),L=async(t,a)=>{if(e)try{await l.h.panelAction(e,t,"theme",{theme:"light"===a?"dark":"light"}),j({type:"success",title:k("tickets.theme.updated")}),await F(e)}catch(e){j({type:"error",title:k("tickets.actionFail"),description:null==e?void 0:e.message})}},T=async(t,a)=>{if(e)try{await l.h.panelAction(e,t,"template",{template:a}),j({type:"success",title:k("tickets.template.updated")}),await F(e)}catch(e){j({type:"error",title:k("tickets.actionFail"),description:null==e?void 0:e.message})}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:k("tickets.panels.title")}),(0,s.jsx)("button",{type:"button",onClick:()=>e&&F(e),className:"btn btn-secondary",title:k("tickets.reload"),children:k("tickets.reload")}),(0,s.jsx)("button",{type:"button",onClick:P,className:"btn btn-primary",title:k("tickets.scan"),children:k("tickets.scan")})]}),g&&(0,s.jsx)("div",{className:"text-red-400",children:g}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{className:"input",placeholder:k("common.search"),value:_,onChange:e=>S(e.target.value)}),(0,s.jsx)("button",{className:"btn btn-secondary",onClick:()=>S(""),children:k("common.clear")})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:k("tickets.panel.create")}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("form",{onSubmit:A,className:"flex flex-col gap-3",children:[(0,s.jsx)("input",{value:f.name,onChange:e=>N(t=>({...t,name:e.target.value})),placeholder:k("tickets.panels.panelName.placeholder"),className:"input",required:!0}),(0,s.jsxs)("select",{value:f.channelId,onChange:e=>N(t=>({...t,channelId:e.target.value})),className:"input",required:!0,title:"Canal do painel",children:[(0,s.jsx)("option",{value:"",children:k("tickets.panels.selectChannel")}),p.filter(o).map(e=>(0,s.jsx)("option",{value:e.id,children:"#".concat(e.name," (").concat(d(e),")")},e.id))]}),(0,s.jsxs)("select",{value:f.categoryId||"",onChange:e=>N(t=>({...t,categoryId:e.target.value||void 0})),className:"input",title:"Categoria opcional",children:[(0,s.jsx)("option",{value:"",children:k("tickets.panels.noCategory")}),m.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:b,children:k("tickets.panel.create")})]})})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:k("tickets.category.create")}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("form",{onSubmit:E,className:"flex flex-col gap-3",children:[(0,s.jsx)("input",{value:C.name,onChange:e=>w({name:e.target.value}),placeholder:k("tickets.panels.categoryName.placeholder"),className:"input",required:!0}),(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:b,children:k("tickets.category.create")})]})})]})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:k("tickets.panels.list")}),(0,s.jsx)("div",{className:"card-body overflow-auto",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[(0,s.jsx)("thead",{className:"text-left",children:(0,s.jsxs)("tr",{className:"border-b border-neutral-800",children:[(0,s.jsx)("th",{className:"py-2 pr-4",children:k("tickets.table.name")}),(0,s.jsx)("th",{className:"py-2 pr-4",children:k("tickets.table.channel")}),(0,s.jsx)("th",{className:"py-2 pr-4",children:k("tickets.table.message")}),(0,s.jsx)("th",{className:"py-2",children:k("tickets.table.actions")})]})}),(0,s.jsx)("tbody",{children:I.map(t=>(0,s.jsxs)("tr",{className:"border-b border-neutral-900/50",children:[(0,s.jsx)("td",{className:"py-2 pr-4 align-top",children:(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-medium",children:t.name||"-"}),t.detected&&(0,s.jsx)("span",{className:"text-xs text-amber-400",children:k("tickets.detected")}),t.template&&(0,s.jsxs)("span",{className:"text-xs opacity-70",children:["tpl: ",t.template]}),t.theme&&(0,s.jsxs)("span",{className:"text-xs opacity-70",children:["theme: ",t.theme]})]})}),(0,s.jsx)("td",{className:"py-2 pr-4",children:t.channelLabel}),(0,s.jsx)("td",{className:"py-2 pr-4",children:t.message_id?(0,s.jsx)("a",{className:"link",href:"https://discord.com/channels/".concat(e,"/").concat(t.channel_id,"/").concat(t.message_id),target:"_blank",rel:"noreferrer",children:t.message_id}):"-"}),(0,s.jsx)("td",{className:"py-2",children:(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[t.detected?(0,s.jsx)("button",{type:"button",className:"btn btn-primary btn-xs",onClick:()=>e&&l.h.panelAction(e,t._id,"save").then(()=>{j({type:"success",title:k("tickets.saved")}),F(e)}).catch(e=>j({type:"error",title:k("tickets.actionFail"),description:null==e?void 0:e.message})),children:k("tickets.action.save")}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{type:"button",className:"btn btn-secondary btn-xs",onClick:()=>e&&l.h.panelAction(e,t._id,"resend").then(()=>{j({type:"success",title:k("tickets.action.resend.ok")}),F(e)}).catch(e=>j({type:"error",title:k("tickets.actionFail"),description:null==e?void 0:e.message})),children:k("tickets.action.resend")}),(0,s.jsx)("button",{type:"button",className:"btn btn-secondary btn-xs",onClick:()=>e&&l.h.panelAction(e,t._id,"recreate").then(()=>{j({type:"success",title:k("tickets.action.recreate.ok")}),F(e)}).catch(e=>j({type:"error",title:k("tickets.actionFail"),description:null==e?void 0:e.message})),children:k("tickets.action.recreate")})]}),(0,s.jsx)("select",{className:"input input-xs",value:t.template||"classic",onChange:e=>T(t._id,e.target.value),title:k("tickets.template.set"),children:["classic","compact","premium","minimal","gamer"].map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),(0,s.jsx)("button",{type:"button",className:"btn btn-secondary btn-xs",onClick:()=>L(t._id,t.theme),children:k("tickets.theme.toggle")}),(0,s.jsx)("button",{type:"button",className:"btn btn-danger btn-xs",onClick:()=>{e&&confirm(k("tickets.confirmDelete"))&&l.h.panelAction(e,t._id,"delete").then(()=>{j({type:"success",title:k("tickets.removed")}),F(e)}).catch(e=>j({type:"error",title:k("tickets.actionFail"),description:null==e?void 0:e.message}))},children:k("tickets.action.delete")})]})})]},t._id))})]})})]})]})}},8183:function(e,t,a){"use strict";a.d(t,{ToasterProvider:function(){return i},p:function(){return l}});var s=a(7437),n=a(2265);let c=(0,n.createContext)(null);function l(){let e=(0,n.useContext)(c);if(!e)throw Error("useToast must be used within <ToasterProvider />");return e}function i(e){let{children:t}=e,[a,l]=(0,n.useState)([]),i=(0,n.useRef)(0),r=(0,n.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e))},[]),o=(0,n.useCallback)(e=>{let t="".concat(Date.now(),"_").concat(i.current++),a={id:t,...e};l(e=>[...e,a]),window.setTimeout(()=>r(t),4500)},[r]),d=(0,n.useMemo)(()=>({toast:o}),[o]);return(0,s.jsxs)(c.Provider,{value:d,children:[t,(0,s.jsx)("div",{className:"fixed z-50 right-4 bottom-4 flex flex-col gap-2 w-[min(92vw,380px)]",role:"status","aria-live":"polite",children:a.map(e=>(0,s.jsxs)("div",{className:"rounded-xl border p-3 shadow-lg backdrop-blur card ".concat("success"===e.type?"border-emerald-700/60":"error"===e.type?"border-rose-700/60":"border-neutral-700/60"),children:[e.title&&(0,s.jsx)("div",{className:"text-sm font-semibold mb-0.5",children:e.title}),e.description&&(0,s.jsx)("div",{className:"text-xs text-neutral-300",children:e.description})]},e.id))})]})}}},function(e){e.O(0,[814,482,971,23,744],function(){return e(e.s=6e3)}),_N_E=e.O()}]);