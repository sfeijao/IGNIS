(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[988],{386:function(e,t,a){Promise.resolve().then(a.bind(a,1472)),Promise.resolve().then(a.bind(a,912)),Promise.resolve().then(a.bind(a,1481))},1472:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var r=a(7437),s=a(2265),l=a(9988),n=a(2837);function i(e){let{guildId:t,ticketId:a,onClose:n}=e,[i,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(null),[x,h]=(0,s.useState)(null),[g,p]=(0,s.useState)(null),[b,f]=(0,s.useState)(0),[v,j]=(0,s.useState)(!1),[y,N]=(0,s.useState)("overview"),[w,k]=(0,s.useState)([]),[S,C]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=!1;return(async()=>{d(!0),m(null);try{let s=await l.h.getTicketDetails(t,a),n=await l.h.getTicketLogs(t,a,{limit:200,offset:0});if(!e){var r;h(s),p(n),f((null==n?void 0:null===(r=n.logs)||void 0===r?void 0:r.length)||0);try{let r=await l.h.getTicketMessages(t,a,{limit:100});e||(k(r.messages||[]),C(r.nextBefore||null))}catch(e){}}}catch(t){e||m((null==t?void 0:t.message)||"Failed to load ticket")}finally{e||d(!1)}})(),()=>{e=!0}},[t,a]);let P=async()=>{if(!v)try{var e;j(!0);let r=await l.h.getTicketLogs(t,a,{limit:200,offset:b});p(e=>e?{...e,logs:[...e.logs,...r.logs]}:r),f(b+((null==r?void 0:null===(e=r.logs)||void 0===e?void 0:e.length)||0))}catch(e){}finally{j(!1)}},T=async()=>{if(S)try{let e=await l.h.getTicketMessages(t,a,{limit:100,before:S});k(t=>[...e.messages||[],...t]),C(e.nextBefore||null)}catch(e){}};return(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:n}),(0,r.jsxs)("div",{className:"relative z-10 w-full max-w-5xl card p-0 overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-5 py-3 border-b border-neutral-800",children:[(0,r.jsxs)("div",{className:"font-semibold",children:["Ticket #",a]}),(0,r.jsx)("button",{onClick:n,className:"text-neutral-400 hover:text-white",children:"✕"})]}),i&&(0,r.jsx)("div",{className:"p-6 text-neutral-400",children:"Carregando…"}),u&&(0,r.jsx)("div",{className:"p-6 text-red-400",children:u}),!i&&!u&&x&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"px-5 pt-3 flex items-center gap-2 border-b border-neutral-800",children:[(0,r.jsx)("button",{className:"px-3 py-2 text-sm rounded-t ".concat("overview"===y?"bg-neutral-800 border border-neutral-700 border-b-neutral-800":"text-neutral-400 hover:text-white"),onClick:()=>N("overview"),children:"Overview"}),(0,r.jsx)("button",{className:"px-3 py-2 text-sm rounded-t ".concat("logs"===y?"bg-neutral-800 border border-neutral-700 border-b-neutral-800":"text-neutral-400 hover:text-white"),onClick:()=>N("logs"),children:"Logs"}),(0,r.jsx)("button",{className:"px-3 py-2 text-sm rounded-t ".concat("transcript"===y?"bg-neutral-800 border border-neutral-700 border-b-neutral-800":"text-neutral-400 hover:text-white"),onClick:()=>N("transcript"),children:"Transcript"}),"transcript"===y&&(0,r.jsx)("a",{className:"ml-auto mr-5 text-sm text-blue-400 hover:text-blue-300 underline",href:"/api/guild/".concat(t,"/tickets/").concat(a,"?download=transcript"),target:"_blank",rel:"noreferrer",children:"Download transcript"})]}),"overview"===y&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 divide-y md:divide-y-0 md:divide-x divide-neutral-800",children:[(0,r.jsxs)("div",{className:"p-4 space-y-2",children:[(0,r.jsx)(c,{label:"Status",value:x.ticket.status}),(0,r.jsx)(c,{label:"Priority",value:x.ticket.priority||"normal"}),(0,r.jsx)(c,{label:"Owner",value:"".concat(x.ticket.ownerTag," (").concat(x.ticket.user_id,")")}),x.ticket.claimedByTag&&(0,r.jsx)(c,{label:"Claimed by",value:x.ticket.claimedByTag}),(0,r.jsx)(c,{label:"Channel",value:"".concat(x.ticket.channelName," (").concat(x.ticket.channel_id,")")}),(0,r.jsx)(c,{label:"Opened",value:x.ticket.timeAgo})]}),(0,r.jsxs)("div",{className:"p-4 md:col-span-2",children:[(0,r.jsx)("div",{className:"font-medium mb-2",children:"Recent activity"}),(0,r.jsx)("div",{className:"max-h-96 overflow-auto pr-1",children:(0,r.jsx)(o,{items:((null==g?void 0:g.logs)||[]).slice(0,20)})})]})]}),"logs"===y&&(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"font-medium mb-2",children:"Logs"}),(0,r.jsx)("div",{className:"max-h-96 overflow-auto pr-1",children:(0,r.jsx)(o,{items:(null==g?void 0:g.logs)||[]})}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)("button",{onClick:P,disabled:v,className:"px-3 py-1.5 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700 disabled:opacity-50 text-sm",children:v?"Loading…":"Load more"})})]}),"transcript"===y&&(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("div",{className:"font-medium mb-2",children:"Transcript"}),(0,r.jsxs)("div",{className:"max-h-[28rem] overflow-auto space-y-3",children:[w.map(e=>{var t,a;return(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsxs)("span",{className:"text-neutral-500",children:["[",new Date(e.timestamp).toLocaleString(),"]"]})," ",(0,r.jsxs)("span",{className:"text-neutral-300",children:[null===(t=e.author)||void 0===t?void 0:t.username,"#",null===(a=e.author)||void 0===a?void 0:a.discriminator]}),":"," ",(0,r.jsx)("span",{className:"text-neutral-200 whitespace-pre-wrap break-words",children:e.content||""})]},e.id)}),0===w.length&&(0,r.jsx)("div",{className:"text-neutral-400 text-sm",children:"No recent messages captured. Try the Download transcript link for a full export."})]}),(0,r.jsx)("div",{className:"mt-3 flex items-center gap-2",children:(0,r.jsx)("button",{onClick:T,disabled:!S,className:"px-3 py-1.5 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700 disabled:opacity-50 text-sm",children:S?"Load older messages":"No more messages"})})]})]})]})]})}function c(e){let{label:t,value:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm text-neutral-400",children:t}),(0,r.jsx)("div",{className:"text-neutral-200",children:a})]})}function o(e){let{items:t}=e;return(0,r.jsx)("ol",{className:"relative border-l border-neutral-800 pl-4",children:t.map((e,t)=>(0,r.jsxs)("li",{className:"mb-4 ml-2",children:[(0,r.jsx)("div",{className:"absolute -left-1.5 mt-1.5 w-3 h-3 bg-neutral-700 rounded-full border border-neutral-600"}),(0,r.jsx)("time",{className:"text-xs text-neutral-500",children:new Date(e.timestamp).toLocaleString()}),(0,r.jsxs)("div",{className:"text-sm text-neutral-300",children:[(0,r.jsx)("span",{className:"font-semibold",children:e.action}),e.actorTag?" by ".concat(e.actorTag):""]}),e.message&&(0,r.jsx)("div",{className:"text-sm text-neutral-400 whitespace-pre-wrap break-words",children:e.message})]},t))})}let d=["","open","claimed","closed","pending"],u=["","low","normal","high","urgent"];function m(){var e,t;let a=(0,n._)(),[c,o]=(0,s.useState)(""),[m,h]=(0,s.useState)(""),[g,p]=(0,s.useState)(""),[b,f]=(0,s.useState)(1),[v,j]=(0,s.useState)(20),[y,N]=(0,s.useState)(!1),[w,k]=(0,s.useState)(null),[S,C]=(0,s.useState)(null),[P,T]=(0,s.useState)({}),[L,F]=(0,s.useState)(null),[O,E]=(0,s.useState)([]),[R,I]=(0,s.useState)(""),[U,A]=(0,s.useState)([]),[_,M]=(0,s.useState)(""),[D,B]=(0,s.useState)(!1),[q,z]=(0,s.useState)(!1),[J,G]=(0,s.useState)(null),V=(0,s.useMemo)(()=>{let e=O.find(e=>e.id===R);return e?e.name:""},[O,R]),W=(0,s.useMemo)(()=>({status:c,priority:m,q:g,page:b,pageSize:v,staffOnly:D,role:D?R:"",deepRoleFetch:q}),[c,m,g,b,v,D,R,q]);(0,s.useEffect)(()=>{let e=new URLSearchParams(window.location.search),t=e.get("status")||"",a=e.get("priority")||"",r=e.get("q")||"",s=parseInt(e.get("page")||"1",10),n=parseInt(e.get("pageSize")||"20",10),i="true"===(e.get("staffOnly")||"").toLowerCase(),c=e.get("role")||"",d="true"===(e.get("deepRoleFetch")||"").toLowerCase();t&&o(t),a&&h(a),r&&p(r),!Number.isNaN(s)&&s>0&&f(s),!Number.isNaN(n)&&[10,20,50,100].includes(n)&&j(n),B(i),c&&I(c),z(d),(async()=>{try{var e;let t=await l.h.getCurrentUser();G((null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.id)||null)}catch(e){}})()},[]),(0,s.useEffect)(()=>{let e=new URL(window.location.href);c?e.searchParams.set("status",c):e.searchParams.delete("status"),m?e.searchParams.set("priority",m):e.searchParams.delete("priority"),g?e.searchParams.set("q",g):e.searchParams.delete("q"),e.searchParams.set("page",String(b)),e.searchParams.set("pageSize",String(v)),D?e.searchParams.set("staffOnly","true"):e.searchParams.delete("staffOnly"),D&&R?e.searchParams.set("role",R):e.searchParams.delete("role"),q?e.searchParams.set("deepRoleFetch","true"):e.searchParams.delete("deepRoleFetch"),window.history.replaceState({},"",e.toString())},[c,m,g,b,v,D,R,q]),(0,s.useEffect)(()=>{if(!a)return;let e=!1;return(async()=>{try{let t=await l.h.getRoles(a);e||E((t.roles||[]).map(e=>({id:String(e.id),name:String(e.name)})))}catch(e){}})(),()=>{e=!0}},[a]),(0,s.useEffect)(()=>{if(!a||!R){A([]),M("");return}let e=!1;return(async()=>{try{let t=await l.h.getMembers(a,{role:R,limit:200});e||A((t||[]).map(e=>({id:String(e.id),username:String(e.username),discriminator:String(e.discriminator),nick:e.nick||null})))}catch(t){e||A([])}})(),()=>{e=!0}},[a,R]),(0,s.useEffect)(()=>{if(!a)return;let e=!1;return(async()=>{N(!0),k(null);try{let t=await l.h.getTickets(a,W);e||C(t)}catch(t){e||k((null==t?void 0:t.message)||"Failed to load tickets")}finally{e||N(!1)}})(),()=>{e=!0}},[a,W]);let H=async(e,t)=>{if(a)try{await l.h.ticketAction(a,e,t);let r=await l.h.getTickets(a,W);C(r)}catch(e){alert((null==e?void 0:e.message)||"Failed to perform action")}},K=e=>{let t={};for(let a of(null==S?void 0:S.tickets)||[])t[a.id]=e;T(t)},Q=(0,s.useMemo)(()=>Object.keys(P).filter(e=>P[e]),[P]),X=async()=>{if(a&&0!==Q.length&&confirm("Close ".concat(Q.length," tickets?"))){for(let e of Q)try{await l.h.ticketAction(a,e,"close")}catch(e){}C(await l.h.getTickets(a,W)),T({})}},Y=async()=>{if(!a||0===Q.length)return;let e=_||"";if(!e){alert("Select a staff role and assignee.");return}for(let t of Q)try{await l.h.ticketAction(a,t,"assign",{userId:e})}catch(e){}C(await l.h.getTickets(a,W)),T({})},Z=async()=>{if(!a||0===Q.length)return;let e=prompt("Add note to selected tickets:");if(e){for(let t of Q)try{await l.h.ticketAction(a,t,"addNote",{content:e})}catch(e){}C(await l.h.getTickets(a,W)),T({})}};return(0,r.jsxs)("div",{className:"space-y-4",children:[!a&&(0,r.jsxs)("div",{className:"card p-4 text-sm text-neutral-400",children:["Selecione um servidor: adicione ",(0,r.jsx)("span",{className:"text-neutral-200",children:"?guildId=SEU_GUILD_ID"})," \xe0 URL ou salve via localStorage."]}),(0,r.jsxs)("div",{className:"card p-4 grid grid-cols-1 md:grid-cols-8 gap-3 items-end",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",children:"Status"}),(0,r.jsx)("select",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1","aria-label":"Filter by status",title:"Filter by status",value:c,onChange:e=>{f(1),o(e.target.value)},children:d.map(e=>(0,r.jsx)("option",{value:e,children:e||"Any"},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",children:"Priority"}),(0,r.jsx)("select",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1","aria-label":"Filter by priority",title:"Filter by priority",value:m,onChange:e=>{f(1),h(e.target.value)},children:u.map(e=>(0,r.jsx)("option",{value:e,children:e||"Any"},e))})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",children:"Search"}),(0,r.jsx)("input",{className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",placeholder:"ID, subject, user, channel...",value:g,onChange:e=>{f(1),p(e.target.value)}})]}),(0,r.jsxs)("div",{className:"flex gap-2 md:col-span-3",children:[(0,r.jsx)("button",{onClick:()=>{if(!a)return;let e=l.h.exportTicketsUrl(a,W);window.open(e,"_blank")},className:"mt-5 bg-neutral-800 hover:bg-neutral-700 text-sm px-3 py-2 rounded border border-neutral-700",children:"Export"}),(0,r.jsxs)("div",{className:"ml-auto flex items-end gap-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",children:"Staff role"}),(0,r.jsxs)("select",{className:"mt-1 w-40 bg-neutral-900 border border-neutral-700 rounded px-2 py-1","aria-label":"Staff role",title:"Staff role",value:R,onChange:e=>{I(e.target.value),M("")},children:[(0,r.jsx)("option",{value:"",children:"Select role"}),O.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",children:"Assignee"}),(0,r.jsxs)("select",{className:"mt-1 w-48 bg-neutral-900 border border-neutral-700 rounded px-2 py-1","aria-label":"Assignee",title:"Assignee",value:_,onChange:e=>M(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"Select member"}),U.map(e=>(0,r.jsx)("option",{value:e.id,children:e.nick?"".concat(e.nick," (").concat(e.username,"#").concat(e.discriminator,")"):"".concat(e.username,"#").concat(e.discriminator)},e.id))]})]}),(0,r.jsxs)("div",{className:"mt-5 flex items-center gap-2",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2 text-xs text-neutral-300",children:[(0,r.jsx)("input",{type:"checkbox",checked:D,onChange:e=>{B(e.target.checked),f(1)}})," Staff only"]}),(0,r.jsxs)("label",{className:"flex items-center gap-2 text-xs text-neutral-300",children:[(0,r.jsx)("input",{type:"checkbox",checked:q,onChange:e=>z(e.target.checked)})," Deep fetch"]})]})]})]})]}),(D||!!R||q||!!c||!!m||!!g)&&(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[(0,r.jsx)("span",{className:"text-neutral-400 mr-1",children:"Filters applied:"}),!!c&&(0,r.jsxs)("span",{className:"px-2 py-0.5 rounded bg-neutral-800 border border-neutral-700 text-neutral-200",children:["Status: ",c]}),!!m&&(0,r.jsxs)("span",{className:"px-2 py-0.5 rounded bg-neutral-800 border border-neutral-700 text-neutral-200",children:["Priority: ",m]}),!!g&&(0,r.jsxs)("span",{className:"px-2 py-0.5 rounded bg-neutral-800 border border-neutral-700 text-neutral-200",children:["Search: “",g,"”"]}),D&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded bg-neutral-800 border border-neutral-700 text-neutral-200",children:"Staff only"}),!!R&&(0,r.jsxs)("span",{className:"px-2 py-0.5 rounded bg-neutral-800 border border-neutral-700 text-neutral-200",children:["Role: ",V||R]}),q&&(0,r.jsx)("span",{className:"px-2 py-0.5 rounded bg-neutral-800 border border-neutral-700 text-neutral-200",children:"Deep fetch"}),(0,r.jsx)("button",{type:"button",className:"ml-1 underline text-neutral-400 hover:text-neutral-200",onClick:()=>{o(""),h(""),p(""),B(!1),I(""),z(!1),f(1)},"aria-label":"Clear filters",title:"Clear filters",children:"Clear"})]}),S&&(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[(0,r.jsx)(x,{label:"Total",value:S.stats.total,colorClass:"bg-neutral-400"}),(0,r.jsx)(x,{label:"Open",value:S.stats.open,colorClass:"bg-emerald-500"}),(0,r.jsx)(x,{label:"Claimed",value:S.stats.claimed,colorClass:"bg-amber-500"}),(0,r.jsx)(x,{label:"Closed",value:S.stats.closed,colorClass:"bg-rose-500"}),(0,r.jsx)(x,{label:"Pending",value:S.stats.pending,colorClass:"bg-blue-500"})]}),(0,r.jsxs)("div",{className:"card p-0 overflow-hidden",children:[(0,r.jsxs)("div",{className:"divide-y divide-neutral-800",children:[y&&(0,r.jsx)("div",{className:"p-6 text-neutral-400",children:"Loading…"}),w&&(0,r.jsx)("div",{className:"p-6 text-red-400",children:w}),!y&&!w&&(null==S?void 0:null===(e=S.tickets)||void 0===e?void 0:e.length)===0&&(0,r.jsx)("div",{className:"p-6 text-neutral-400",children:"No tickets found."}),null==S?void 0:null===(t=S.tickets)||void 0===t?void 0:t.map(e=>(0,r.jsxs)("div",{className:"p-4 flex flex-col md:flex-row md:items-center gap-3",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("input",{type:"checkbox","aria-label":"Select ticket ".concat(e.id),checked:!!P[e.id],onChange:t=>T(a=>({...a,[e.id]:t.target.checked}))})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsxs)("span",{className:"text-neutral-300 font-mono",children:["#",e.id]}),(0,r.jsx)("span",{className:"px-2 py-0.5 text-xs rounded bg-neutral-800 border border-neutral-700",children:e.status}),e.priority&&(0,r.jsx)("span",{className:"px-2 py-0.5 text-xs rounded bg-neutral-800 border border-neutral-700",children:e.priority}),e.timeAgo&&(0,r.jsx)("span",{className:"text-xs text-neutral-500",children:e.timeAgo})]}),(0,r.jsx)("div",{className:"mt-1 text-neutral-200 truncate",children:e.subject||e.category||"Ticket"}),(0,r.jsxs)("div",{className:"mt-1 text-xs text-neutral-400 truncate",children:[e.ownerTag," • ",e.channelName]}),e.claimedByTag&&(0,r.jsxs)("div",{className:"mt-1 text-xs text-neutral-400",children:["Claimed by ",e.claimedByTag]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>F(e.id),className:"bg-neutral-800 hover:bg-neutral-700 px-3 py-1.5 rounded text-sm border border-neutral-700",children:"View"}),"open"===e.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>H(e.id,"claim"),className:"bg-emerald-600 hover:bg-emerald-500 px-3 py-1.5 rounded text-sm",children:"Claim"}),(0,r.jsx)("button",{onClick:()=>H(e.id,"claim"),className:"bg-blue-600 hover:bg-blue-500 px-3 py-1.5 rounded text-sm",children:"Assign to me"})]}),"claimed"===e.status&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>H(e.id,"release"),className:"bg-neutral-700 hover:bg-neutral-600 px-3 py-1.5 rounded text-sm",children:"Release"}),(0,r.jsx)("button",{onClick:()=>H(e.id,"close"),className:"bg-rose-600 hover:bg-rose-500 px-3 py-1.5 rounded text-sm",children:"Close"}),J&&(0,r.jsx)("button",{onClick:()=>l.h.ticketAction(a,e.id,"assign",{userId:J}).then(()=>l.h.getTickets(a,W).then(C)),className:"bg-blue-600 hover:bg-blue-500 px-3 py-1.5 rounded text-sm",children:"Assign to me"})]}),"open"===e.status&&(0,r.jsx)("button",{onClick:()=>H(e.id,"close"),className:"bg-rose-600 hover:bg-rose-500 px-3 py-1.5 rounded text-sm",children:"Close"})]})]},e.id))]}),(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 border-t border-neutral-800 text-sm",children:[(0,r.jsxs)("div",{className:"text-neutral-400",children:["Page ",(null==S?void 0:S.pagination.page)||b," / ",(null==S?void 0:S.pagination.totalPages)||1]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox","aria-label":"Select all on page",onChange:e=>K(e.target.checked)}),Q.length>0&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-neutral-400",children:[Q.length," selected"]}),(0,r.jsx)("button",{onClick:X,className:"px-3 py-1.5 rounded bg-rose-600 hover:bg-rose-500",children:"Close"}),(0,r.jsx)("button",{onClick:Y,className:"px-3 py-1.5 rounded bg-neutral-700 hover:bg-neutral-600",children:"Assign"}),(0,r.jsx)("button",{onClick:Z,className:"px-3 py-1.5 rounded bg-blue-600 hover:bg-blue-500",children:"Add note"})]}),(0,r.jsx)("button",{className:"px-3 py-1.5 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700 disabled:opacity-50",disabled:1>=((null==S?void 0:S.pagination.page)||b),onClick:()=>f(((null==S?void 0:S.pagination.page)||b)-1),children:"Prev"}),(0,r.jsx)("button",{className:"px-3 py-1.5 rounded bg-neutral-800 border border-neutral-700 hover:bg-neutral-700 disabled:opacity-50",disabled:((null==S?void 0:S.pagination.page)||b)>=((null==S?void 0:S.pagination.totalPages)||1),onClick:()=>f(((null==S?void 0:S.pagination.page)||b)+1),children:"Next"}),(0,r.jsx)("select",{className:"ml-2 bg-neutral-900 border border-neutral-700 rounded px-2 py-1","aria-label":"Items per page",title:"Items per page",value:v,onChange:e=>{f(1),j(parseInt(e.target.value,10))},children:[10,20,50,100].map(e=>(0,r.jsxs)("option",{value:e,children:[e,"/page"]},e))})]})]})]}),a&&L&&(0,r.jsx)(i,{guildId:a,ticketId:L,onClose:()=>F(null)})]})}function x(e){let{label:t,value:a,colorClass:s}=e;return(0,r.jsxs)("div",{className:"card p-4",children:[(0,r.jsx)("div",{className:"text-sm text-neutral-400",children:t}),(0,r.jsxs)("div",{className:"mt-1 text-2xl font-semibold flex items-center gap-2",children:[(0,r.jsx)("span",{className:"inline-block w-2 h-2 rounded-full ".concat(s)}),a]})]})}},9988:function(e,t,a){"use strict";a.d(t,{h:function(){return r}});let r={async getLogStats(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",r=await fetch("/api/guild/".concat(e,"/logs/stats").concat(a),{credentials:"include"});if(!r.ok)throw Error("Failed to fetch stats");return r.json()},async getLogs(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",r=await fetch("/api/guild/".concat(e,"/logs").concat(a),{credentials:"include"});if(!r.ok)throw Error("Failed to fetch logs");return r.json()},exportLogsUrl(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"";return"/api/guild/".concat(e,"/logs/export").concat(a)},async getSettings(e){let t=await fetch("/api/guild/".concat(e,"/settings"),{credentials:"include"});if(!t.ok)throw Error("Failed to fetch settings");return t.json()},async postSettings(e,t){let a=await fetch("/api/guild/".concat(e,"/settings"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!a.ok)throw Error("Failed to save settings");return a.json()},async getRoles(e){let t=await fetch("/api/guild/".concat(e,"/roles"),{credentials:"include"});if(!t.ok)throw Error("Failed to fetch roles");return t.json()},async getMembers(e,t){let a=t?new URLSearchParams(Object.entries(t).filter(e=>{let[,t]=e;return null!=t}).map(e=>{let[t,a]=e;return[t,String(a)]})).toString():"",r=await fetch("/api/guild/".concat(e,"/members").concat(a?"?".concat(a):""),{credentials:"include"});if(!r.ok)throw Error("Failed to fetch members");return r.json()},async getCurrentUser(){let e=await fetch("/api/user",{credentials:"include"});if(!e.ok)throw Error("Failed to fetch current user");return e.json()},async getTickets(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",r=await fetch("/api/guild/".concat(e,"/tickets").concat(a),{credentials:"include"});if(!r.ok)throw Error("Failed to fetch tickets");return r.json()},exportTicketsUrl(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"";return"/api/guild/".concat(e,"/tickets/export").concat(a)},async getTicketDetails(e,t){let a=await fetch("/api/guild/".concat(e,"/tickets/").concat(t),{credentials:"include"});if(!a.ok)throw Error("Failed to fetch ticket details");return a.json()},async getTicketLogs(e,t,a){let r=a?"?".concat(new URLSearchParams(Object.entries(a).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",s=await fetch("/api/guild/".concat(e,"/tickets/").concat(t,"/logs").concat(r),{credentials:"include"});if(!s.ok)throw Error("Failed to fetch ticket logs");return s.json()},async getTicketMessages(e,t,a){let r=a?"?".concat(new URLSearchParams(Object.entries(a).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",s=await fetch("/api/guild/".concat(e,"/tickets/").concat(t,"/messages").concat(r),{credentials:"include"});if(!s.ok)throw Error("Failed to fetch ticket messages");return s.json()},async ticketAction(e,t,a,r){let s=await fetch("/api/guild/".concat(e,"/tickets/").concat(t,"/action"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({action:a,data:r})});if(!s.ok)throw Error("Failed to perform ticket action");return s.json()}}},2837:function(e,t,a){"use strict";function r(){return new URL(window.location.href).searchParams.get("guildId")||localStorage.getItem("guildId")}function s(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=(e||"").trim();if(a?localStorage.setItem("guildId",a):localStorage.removeItem("guildId"),t)try{let e=new URL(window.location.href);a?e.searchParams.set("guildId",a):e.searchParams.delete("guildId"),window.history.replaceState({},"",e.toString())}catch(e){}}a.d(t,{J:function(){return s},_:function(){return r}})},912:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let r=a(5592);function s(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return a}},1481:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return l}});let r=a(7437),s=a(8512);function l(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=(0,s.getExpectedRequestStore)("next/dynamic css"),l=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files.filter(e=>e.endsWith(".css"));l.push(...t)}}return 0===l.length?null:(0,r.jsx)(r.Fragment,{children:l.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:a.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=386)}),_N_E=e.O()}]);