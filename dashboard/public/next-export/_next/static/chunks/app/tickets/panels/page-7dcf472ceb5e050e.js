(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[741],{6e3:function(e,a,t){Promise.resolve().then(t.bind(t,4051))},4051:function(e,a,t){"use strict";t.d(a,{default:function(){return c}});var s=t(7437),l=t(2265),n=t(2837),r=t(9988),i=t(8183);function c(){let[e,a]=(0,l.useState)(null),[t,c]=(0,l.useState)([]),[d,o]=(0,l.useState)([]),[u,m]=(0,l.useState)([]),[h,p]=(0,l.useState)(!1),[x,g]=(0,l.useState)(null),{toast:b}=(0,i.p)(),[N,y]=(0,l.useState)({name:"",channelId:""}),[v,j]=(0,l.useState)({name:""});(0,l.useEffect)(()=>{a((0,n._)())},[]);let f=async e=>{p(!0),g(null);try{let[a,t,s]=await Promise.all([r.h.getPanels(e),r.h.getCategories(e),r.h.getChannels(e)]);c((null==a?void 0:a.panels)||a||[]),o((null==t?void 0:t.categories)||t||[]),m(((null==s?void 0:s.channels)||s||[]).filter(e=>e&&e.id&&e.name))}catch(e){g((null==e?void 0:e.message)||"Erro ao carregar")}finally{p(!1)}};(0,l.useEffect)(()=>{e&&f(e)},[e]);let C=async()=>{if(e){p(!0);try{await r.h.scanPanels(e),b({type:"success",title:"Varredura conclu\xedda"})}catch(e){b({type:"error",title:"Falha ao escanear",description:null==e?void 0:e.message})}await f(e)}},w=async a=>{if(a.preventDefault(),e&&N.name&&N.channelId){p(!0);try{await r.h.createPanel(e,N),b({type:"success",title:"Painel criado"}),y({name:"",channelId:""}),await f(e)}catch(e){b({type:"error",title:"Falha ao criar painel",description:null==e?void 0:e.message})}finally{p(!1)}}},S=async a=>{if(a.preventDefault(),e&&v.name){p(!0);try{await r.h.createCategory(e,v),b({type:"success",title:"Categoria criada"}),j({name:""}),await f(e)}catch(e){b({type:"error",title:"Falha ao criar categoria",description:null==e?void 0:e.message})}finally{p(!1)}}},k=(0,l.useMemo)(()=>t.map(e=>{let a=u.find(a=>a.id===e.channelId),t=d.find(a=>a.id===e.categoryId);return{...e,channelName:(null==a?void 0:a.name)||"-",categoryName:(null==t?void 0:t.name)||"-"}}),[t,u,d]);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Tickets: Pain\xe9is e Categorias"}),(0,s.jsx)("button",{onClick:()=>e&&f(e),className:"btn btn-secondary",title:"Recarregar",children:"Recarregar"}),(0,s.jsx)("button",{onClick:C,className:"btn btn-primary",title:"Escanear pain\xe9is",children:"Escanear"})]}),x&&(0,s.jsx)("div",{className:"text-red-400",children:x}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:"Criar Painel"}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("form",{onSubmit:w,className:"flex flex-col gap-3",children:[(0,s.jsx)("input",{value:N.name,onChange:e=>y(a=>({...a,name:e.target.value})),placeholder:"Nome do painel",className:"input",required:!0}),(0,s.jsxs)("select",{value:N.channelId,onChange:e=>y(a=>({...a,channelId:e.target.value})),className:"input",required:!0,title:"Canal do painel",children:[(0,s.jsx)("option",{value:"",children:"Selecione o canal"}),u.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsxs)("select",{value:N.categoryId||"",onChange:e=>y(a=>({...a,categoryId:e.target.value||void 0})),className:"input",title:"Categoria opcional",children:[(0,s.jsx)("option",{value:"",children:"Sem categoria"}),d.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsx)("button",{className:"btn btn-primary",disabled:h,children:"Criar painel"})]})})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:"Criar Categoria"}),(0,s.jsx)("div",{className:"card-body",children:(0,s.jsxs)("form",{onSubmit:S,className:"flex flex-col gap-3",children:[(0,s.jsx)("input",{value:v.name,onChange:e=>j({name:e.target.value}),placeholder:"Nome da categoria",className:"input",required:!0}),(0,s.jsx)("button",{className:"btn btn-primary",disabled:h,children:"Criar categoria"})]})})]})]}),(0,s.jsxs)("section",{className:"card",children:[(0,s.jsx)("div",{className:"card-header",children:"Pain\xe9is"}),(0,s.jsx)("div",{className:"card-body overflow-auto",children:(0,s.jsxs)("table",{className:"min-w-full text-sm",children:[(0,s.jsx)("thead",{className:"text-left",children:(0,s.jsxs)("tr",{className:"border-b border-neutral-800",children:[(0,s.jsx)("th",{className:"py-2 pr-4",children:"Nome"}),(0,s.jsx)("th",{className:"py-2 pr-4",children:"Canal"}),(0,s.jsx)("th",{className:"py-2 pr-4",children:"Categoria"}),(0,s.jsx)("th",{className:"py-2 pr-4",children:"Mensagem"}),(0,s.jsx)("th",{className:"py-2",children:"A\xe7\xf5es"})]})}),(0,s.jsx)("tbody",{children:k.map(a=>(0,s.jsxs)("tr",{className:"border-b border-neutral-900/50",children:[(0,s.jsx)("td",{className:"py-2 pr-4",children:a.name}),(0,s.jsx)("td",{className:"py-2 pr-4",children:a.channelName}),(0,s.jsx)("td",{className:"py-2 pr-4",children:a.categoryName}),(0,s.jsx)("td",{className:"py-2 pr-4",children:a.messageId||"-"}),(0,s.jsxs)("td",{className:"py-2 flex gap-2",children:[(0,s.jsx)("button",{className:"btn btn-secondary btn-xs",title:"Sincronizar",onClick:()=>e&&r.h.panelAction(e,a.id,"sync").then(()=>{b({type:"success",title:"Sincronizado"}),f(e)}).catch(e=>b({type:"error",title:"Falha",description:null==e?void 0:e.message})),children:"Sync"}),(0,s.jsx)("button",{className:"btn btn-secondary btn-xs",title:"Atualizar mensagem",onClick:()=>e&&r.h.panelAction(e,a.id,"refresh_message").then(()=>{b({type:"success",title:"Mensagem atualizada"}),f(e)}).catch(e=>b({type:"error",title:"Falha",description:null==e?void 0:e.message})),children:"Msg"}),(0,s.jsx)("button",{className:"btn btn-danger btn-xs",title:"Remover",onClick:()=>e&&r.h.panelAction(e,a.id,"delete").then(()=>{b({type:"success",title:"Removido"}),f(e)}).catch(e=>b({type:"error",title:"Falha",description:null==e?void 0:e.message})),children:"Del"})]})]},a.id))})]})})]})]})}},8183:function(e,a,t){"use strict";t.d(a,{ToasterProvider:function(){return i},p:function(){return r}});var s=t(7437),l=t(2265);let n=(0,l.createContext)(null);function r(){let e=(0,l.useContext)(n);if(!e)throw Error("useToast must be used within <ToasterProvider />");return e}function i(e){let{children:a}=e,[t,r]=(0,l.useState)([]),i=(0,l.useRef)(0),c=(0,l.useCallback)(e=>{r(a=>a.filter(a=>a.id!==e))},[]),d=(0,l.useCallback)(e=>{let a="".concat(Date.now(),"_").concat(i.current++),t={id:a,...e};r(e=>[...e,t]),window.setTimeout(()=>c(a),4500)},[c]),o=(0,l.useMemo)(()=>({toast:d}),[d]);return(0,s.jsxs)(n.Provider,{value:o,children:[a,(0,s.jsx)("div",{className:"fixed z-50 right-4 bottom-4 flex flex-col gap-2 w-[min(92vw,380px)]",role:"status","aria-live":"polite",children:t.map(e=>(0,s.jsxs)("div",{className:"rounded-xl border p-3 shadow-lg backdrop-blur card ".concat("success"===e.type?"border-emerald-700/60":"error"===e.type?"border-rose-700/60":"border-neutral-700/60"),children:[e.title&&(0,s.jsx)("div",{className:"text-sm font-semibold mb-0.5",children:e.title}),e.description&&(0,s.jsx)("div",{className:"text-xs text-neutral-300",children:e.description})]},e.id))})]})}}},function(e){e.O(0,[482,971,23,744],function(){return e(e.s=6e3)}),_N_E=e.O()}]);