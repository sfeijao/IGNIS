"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[630],{7630:function(e,a,t){t.r(a),t.d(a,{default:function(){return o}});var n=t(7437),l=t(2265),i=t(2837),c=t(7814),r=t(9988);let s=e=>{let a=String(e.type||"").toLowerCase();return a.includes("text")||a.includes("announcement")},d=e=>{switch(String("string"==typeof e?e:(null==e?void 0:e.type)||"").toLowerCase()){case"guild_text":case"text":return"Text";case"guild_announcement":case"announcement":return"Announcement";case"guild_voice":case"voice":return"Voice";case"guild_category":case"category":return"Category";default:return"Channel"}};function o(){let e=(0,i._)(),[a,t]=(0,l.useState)({enabled:!1,method:"captcha",channelId:"",roleId:""}),[o,u]=(0,l.useState)(!1),[h,m]=(0,l.useState)("idle"),[v,x]=(0,l.useState)([]),{t:f}=(0,c.QT)();(0,l.useEffect)(()=>{if(!e)return;let a=!1;return(async()=>{try{let n=await fetch("/api/guild/".concat(e,"/verification/config"),{credentials:"include"});if(n.ok){let e=await n.json();a||t({enabled:!!e.enabled,channelId:e.channelId||"",roleId:e.roleId||"",method:e.method||"captcha"})}}catch(e){}try{let t=await r.h.getChannels(e);a||x(t.channels||t||[])}catch(e){}})(),()=>{a=!0}},[e]);let p=(0,l.useMemo)(()=>v.filter(s),[v]),b=async()=>{if(e){u(!0),m("saving");try{let t=await fetch("/api/guild/".concat(e,"/verification/config"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)});m(t.ok?"ok":"err")}catch(e){m("err")}finally{u(!1),setTimeout(()=>m("idle"),1500)}}};return(0,n.jsxs)("div",{className:"space-y-3",children:[!e&&(0,n.jsx)("div",{className:"card p-4 text-sm text-neutral-400",children:f("verification.selectGuild")}),(0,n.jsxs)("form",{className:"card p-5 max-w-xl space-y-4",onSubmit:e=>{e.preventDefault(),b()},children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{id:"v-enabled",type:"checkbox",checked:!!a.enabled,onChange:e=>t(a=>({...a,enabled:e.target.checked}))}),(0,n.jsx)("label",{htmlFor:"v-enabled",children:f("verification.enable")})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm mb-1",children:f("verification.method")}),(0,n.jsxs)("select",{className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:a.method,onChange:e=>t(a=>({...a,method:e.target.value})),title:"M\xe9todo de verifica\xe7\xe3o",children:[(0,n.jsx)("option",{value:"captcha",children:f("verification.method.captcha")}),(0,n.jsx)("option",{value:"button",children:f("verification.method.button")})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm mb-1",children:f("verification.channel")}),(0,n.jsxs)("select",{className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",value:a.channelId||"",onChange:e=>t(a=>({...a,channelId:e.target.value})),title:f("verification.channel"),children:[(0,n.jsx)("option",{value:"",children:"â€”"}),p.map(e=>(0,n.jsx)("option",{value:e.id,children:"#".concat(e.name," (").concat(d(e),")")},e.id))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm mb-1",children:f("verification.role")}),(0,n.jsx)("input",{className:"w-full rounded-lg bg-neutral-900 border border-neutral-800 px-3 py-2",placeholder:"Role ID",value:a.roleId||"",onChange:e=>t(a=>({...a,roleId:e.target.value}))})]}),(0,n.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,n.jsx)("button",{disabled:o,className:"px-4 py-2 rounded-lg bg-brand-600 hover:bg-brand-700 font-medium disabled:opacity-60",children:f("saving"===h?"verification.saving":"verification.save")}),"ok"===h&&(0,n.jsx)("span",{className:"text-emerald-400 text-sm",children:f("verification.saved")}),"err"===h&&(0,n.jsx)("span",{className:"text-rose-400 text-sm",children:f("verification.saveFailed")})]})]})]})}}}]);