(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[616],{7616:function(e,t,n){Promise.resolve().then(n.bind(n,3979)),Promise.resolve().then(n.bind(n,6296)),Promise.resolve().then(n.bind(n,912)),Promise.resolve().then(n.bind(n,1481))},3979:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=n(7437),s=n(2265),a=n(2837),l=n(9988),i=n(8183),o=n(7814);function d(){let e=(0,a._)(),{toast:t}=(0,i.p)(),{t:n}=(0,o.QT)(),[d,c]=(0,s.useState)(""),[u,m]=(0,s.useState)("timeout"),[x,h]=(0,s.useState)(600),[b,p]=(0,s.useState)(""),[f,v]=(0,s.useState)(!1),[g,j]=(0,s.useState)([]),[N,y]=(0,s.useState)([]),[w,k]=(0,s.useState)(""),S=e=>{switch(String("string"==typeof e?e:(null==e?void 0:e.type)||"").toLowerCase()){case"guild_text":case"text":return"Text";case"guild_announcement":case"announcement":return"Announcement";case"guild_voice":case"voice":return"Voice";case"guild_category":case"category":return"Category";default:return"Channel"}};(0,s.useEffect)(()=>{e&&(async()=>{try{let t=await l.h.getChannels(e),n=t.channels||t||[];y(n)}catch(e){}})()},[e]),(0,s.useEffect)(()=>{let e=localStorage.getItem("moderationContextChannelId");e&&k(e)},[]),(0,s.useEffect)(()=>{w?localStorage.setItem("moderationContextChannelId",w):localStorage.removeItem("moderationContextChannelId")},[w]);let C=()=>Array.from(new Set(d.split(/[\,\n\s]+/).map(e=>e.trim()).filter(Boolean))),_=async()=>{if(!e)return t({type:"error",title:"Guild missing"});let r=C();if(0===r.length)return t({type:"error",title:n("mod.bulk.noUsers")});v(!0),j([]);let s=[];try{for(let t of r)try{"timeout"===u?await l.h.timeoutMember(e,t,Number(x)||0,b||void 0):"kick"===u?await l.h.kickMember(e,t,b||void 0):"ban"===u&&await l.h.banMember(e,t,{reason:b||void 0,deleteMessageSeconds:Number(x)||0}),s.push({userId:t,ok:!0})}catch(e){s.push({userId:t,ok:!1,error:(null==e?void 0:e.message)||"error"})}j(s);let a=s.filter(e=>e.ok).length,i=s.length-a;t({type:i?"info":"success",title:n("mod.bulk.done"),description:"".concat(a,"/").concat(s.length)})}finally{v(!1)}};return(0,r.jsxs)("div",{className:"card p-4 space-y-3",children:[(0,r.jsxs)("div",{className:"text-lg font-semibold",children:[n("nav.moderation")," – ",n("mod.bulk.title")]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",htmlFor:"context-channel",children:n("mod.context.channel")}),(0,r.jsxs)("select",{id:"context-channel",className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:w,onChange:e=>k(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"—"}),N.filter(e=>{let t=String(e.type||"").toLowerCase();return t.includes("text")||t.includes("announcement")}).map(e=>(0,r.jsx)("option",{value:e.id,children:"#".concat(e.name," (").concat(S(e),")")},e.id))]}),(0,r.jsx)("div",{className:"text-[11px] text-neutral-500 mt-1",children:n("mod.context.hint")})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",htmlFor:"user-ids",children:n("mod.bulk.userIds")}),(0,r.jsx)("textarea",{id:"user-ids",className:"mt-1 w-full min-h-[100px] bg-neutral-900 border border-neutral-700 rounded px-2 py-1 font-mono text-xs",placeholder:"123, 456, 789",value:d,onChange:e=>c(e.target.value)}),(0,r.jsx)("div",{className:"text-[11px] text-neutral-500 mt-1",children:n("mod.bulk.hint")})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",htmlFor:"action",children:n("mod.bulk.action")}),(0,r.jsxs)("select",{id:"action",className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:u,onChange:e=>m(e.target.value),children:[(0,r.jsx)("option",{value:"timeout",children:n("mod.action.timeout")}),(0,r.jsx)("option",{value:"kick",children:n("mod.action.kick")}),(0,r.jsx)("option",{value:"ban",children:n("mod.action.ban")})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",htmlFor:"duration",children:"timeout"===u?n("mod.bulk.durationSeconds"):"ban"===u?n("mod.bulk.deleteMsgSeconds"):n("mod.bulk.durationSeconds")}),(0,r.jsx)("input",{id:"duration",type:"number",className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",value:x,onChange:e=>h(parseInt(e.target.value,10)||0),min:0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs text-neutral-400",htmlFor:"reason",children:n("mod.reason")}),(0,r.jsx)("input",{id:"reason",className:"mt-1 w-full bg-neutral-900 border border-neutral-700 rounded px-2 py-1",placeholder:n("mod.reason.placeholder"),value:b,onChange:e=>p(e.target.value)})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{type:"button",className:"btn btn-primary",onClick:_,disabled:f,children:f?n("common.working"):n("mod.bulk.run")}),(0,r.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{c(""),j([])},disabled:f,children:n("common.clear")})]})]})]}),g.length>0&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("div",{className:"text-sm text-neutral-300 mb-2",children:n("mod.bulk.results")}),(0,r.jsx)("div",{className:"max-h-48 overflow-auto border border-neutral-800 rounded",children:g.map((e,t)=>(0,r.jsxs)("div",{className:"px-3 py-1 text-xs border-b border-neutral-900 ".concat(e.ok?"text-green-400":"text-red-400"),children:[e.userId," — ",e.ok?"OK":e.error||"ERR"]},t))})]})]})}},6296:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var r=n(7437),s=n(2265),a=n(2837);function l(){let e=(0,a._)(),[t,n]=(0,s.useState)(null),[l,i]=(0,s.useState)([]),[o,d]=(0,s.useState)(!1),c=async()=>{if(e){d(!0);try{let t=await fetch("/api/guild/".concat(e,"/mod/stats"),{credentials:"include"}).then(e=>e.json()).catch(()=>null),r=await fetch("/api/guild/".concat(e,"/mod/cases?limit=20"),{credentials:"include"}).then(e=>e.json()).catch(()=>null);n(t),i((null==r?void 0:r.cases)||r||[])}finally{d(!1)}}};return(0,s.useEffect)(()=>{c()},[e]),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"card p-4",children:[o&&(0,r.jsx)("div",{className:"text-neutral-400",children:"A carregar…"}),t&&(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.entries(t.totals||{}).map(e=>{let[t,n]=e;return(0,r.jsxs)("div",{className:"p-3 rounded border border-neutral-800 bg-neutral-900",children:[(0,r.jsx)("div",{className:"text-xs text-neutral-400",children:t}),(0,r.jsx)("div",{className:"text-xl font-semibold",children:String(n)})]},t)})})]}),(0,r.jsx)("div",{className:"card p-0 overflow-hidden",children:(0,r.jsxs)("div",{className:"divide-y divide-neutral-800",children:[l.map((e,t)=>(0,r.jsxs)("div",{className:"p-4 flex items-center gap-3",children:[(0,r.jsx)("div",{className:"font-mono text-xs text-neutral-500",children:e.id||t+1}),(0,r.jsx)("div",{className:"px-2 py-0.5 text-xs rounded bg-neutral-800 border border-neutral-700",children:e.type||"case"}),(0,r.jsx)("div",{className:"flex-1 min-w-0 text-neutral-200 truncate",children:e.reason||"—"}),(0,r.jsxs)("div",{className:"text-xs text-neutral-500",children:[e.userId||"—"," • ",e.moderatorId||"—"]}),(0,r.jsx)("div",{className:"text-xs text-neutral-500",children:e.createdAt?new Date(e.createdAt).toLocaleString():"—"})]},e.id||t)),!o&&0===l.length&&(0,r.jsx)("div",{className:"p-6 text-neutral-400",children:"Sem casos recentes."})]})})]})}},8183:function(e,t,n){"use strict";n.d(t,{ToasterProvider:function(){return i},p:function(){return l}});var r=n(7437),s=n(2265);let a=(0,s.createContext)(null);function l(){let e=(0,s.useContext)(a);if(!e)throw Error("useToast must be used within <ToasterProvider />");return e}function i(e){let{children:t}=e,[n,l]=(0,s.useState)([]),i=(0,s.useRef)(0),o=(0,s.useCallback)(e=>{l(t=>t.filter(t=>t.id!==e))},[]),d=(0,s.useCallback)(e=>{let t="".concat(Date.now(),"_").concat(i.current++),n={id:t,...e};l(e=>[...e,n]),window.setTimeout(()=>o(t),4500)},[o]),c=(0,s.useMemo)(()=>({toast:d}),[d]);return(0,r.jsxs)(a.Provider,{value:c,children:[t,(0,r.jsx)("div",{className:"fixed z-50 right-4 bottom-4 flex flex-col gap-2 w-[min(92vw,380px)]",role:"status","aria-live":"polite",children:n.map(e=>(0,r.jsxs)("div",{className:"rounded-xl border p-3 shadow-lg backdrop-blur card ".concat("success"===e.type?"border-emerald-700/60":"error"===e.type?"border-rose-700/60":"border-neutral-700/60"),children:[e.title&&(0,r.jsx)("div",{className:"text-sm font-semibold mb-0.5",children:e.title}),e.description&&(0,r.jsx)("div",{className:"text-xs text-neutral-300",children:e.description})]},e.id))})]})}},912:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return s}});let r=n(5592);function s(e){let{reason:t,children:n}=e;if("undefined"==typeof window)throw new r.BailoutToCSRError(t);return n}},1481:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadCss",{enumerable:!0,get:function(){return a}});let r=n(7437),s=n(8512);function a(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let n=(0,s.getExpectedRequestStore)("next/dynamic css"),a=[];if(n.reactLoadableManifest&&t){let e=n.reactLoadableManifest;for(let n of t){if(!e[n])continue;let t=e[n].files.filter(e=>e.endsWith(".css"));a.push(...t)}}return 0===a.length?null:(0,r.jsx)(r.Fragment,{children:a.map(e=>(0,r.jsx)("link",{precedence:"dynamic",rel:"stylesheet",href:n.assetPrefix+"/_next/"+encodeURI(e),as:"style"},e))})}}}]);