(function(){ const els={ name:document.getElementById('cmdName'), desc:document.getElementById('cmdDesc'), type:document.getElementById('cmdType'), content:document.getElementById('cmdContent'), preview:document.getElementById('preview'), save:document.getElementById('save') }; function update(){ const name=(els.name?.value||'').trim(); const desc=(els.desc?.value||'').trim(); const type=(els.type?.value||'text'); const content=(els.content?.value||'').trim(); els.save && (els.save.disabled = true); if(type==='embed'){ try{ const obj = content? JSON.parse(content): {}; els.preview.innerHTML = `<div class="embed"><pre>${escapeHtml(JSON.stringify(obj,null,2))}</pre></div>`; } catch(e){ els.preview.textContent = 'JSON inv√°lido'; } } else { els.preview.textContent = content || '(vazio)'; } } function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c]||c)); } ['input','change'].forEach(evt=>{ els.name?.addEventListener(evt, update); els.desc?.addEventListener(evt, update); els.type?.addEventListener(evt, update); els.content?.addEventListener(evt, update); }); update(); })();