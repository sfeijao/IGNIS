(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1387:function(e,t,a){Promise.resolve().then(a.bind(a,1262)),Promise.resolve().then(a.t.bind(a,231,23))},1262:function(e,t,a){"use strict";a.d(t,{default:function(){return c}});var l=a(7437),r=a(2265),s=a(2695);function n(e){let{label:t,value:a,dotColor:r}=e;return(0,l.jsxs)("div",{className:"card card-gradient p-5",children:[(0,l.jsxs)("div",{className:"badge mb-2",children:[(0,l.jsx)("span",{className:"dot",style:{backgroundColor:r}}),t]}),(0,l.jsx)("div",{className:"text-2xl font-semibold",children:a})]})}var i=a(9988),o=a(2837);function c(){let[e,t]=(0,r.useState)([{label:"Ativos",value:"—",color:"#10b981"},{label:"Warnings",value:"—",color:"#f59e0b"},{label:"Bans",value:"—",color:"#ef4444"},{label:"Kicks",value:"—",color:"#f97316"},{label:"Tickets",value:"—",color:"#6366f1"},{label:"Mod logs",value:"—",color:"#22d3ee"}]),[a,c]=(0,r.useState)("—"),[d,u]=(0,r.useState)("—"),[h,v]=(0,r.useState)("Dados ser\xe3o carregados ao selecionar um servidor."),[g,m]=(0,r.useState)(!1),x=(0,r.useRef)(null),[f,p]=(0,r.useState)(1),[w,k]=(0,r.useState)("—"),j=e=>e?e.toLocaleString():"—",b=e=>{var t,a,l,r;for(let s of[null==e?void 0:e.lastActivity,null==e?void 0:e.lastEventAt,null==e?void 0:e.lastLogAt,null==e?void 0:null===(t=e.latest)||void 0===t?void 0:t.timestamp,null==e?void 0:null===(a=e.latest)||void 0===a?void 0:a.at,Array.isArray(null==e?void 0:e.recent)?null===(l=e.recent[0])||void 0===l?void 0:l.timestamp:null,null==e?void 0:null===(r=e.updates)||void 0===r?void 0:r.last].filter(Boolean)){let e=new Date(s);if(!isNaN(e.getTime()))return e}return null},S=e=>{var t,a,l,r,s,n,i;for(let o of[null==e?void 0:null===(t=e.tickets)||void 0===t?void 0:t.lastUpdated,null==e?void 0:null===(a=e.tickets)||void 0===a?void 0:a.last_activity,null==e?void 0:null===(r=e.tickets)||void 0===r?void 0:null===(l=r.latest)||void 0===l?void 0:l.timestamp,null==e?void 0:e.lastTicketAt,null==e?void 0:null===(s=e.latestTicket)||void 0===s?void 0:s.timestamp,Array.isArray(null==e?void 0:null===(n=e.tickets)||void 0===n?void 0:n.recent)?null===(i=e.tickets.recent[0])||void 0===i?void 0:i.timestamp:null].filter(Boolean)){let e=new Date(o);if(!isNaN(e.getTime()))return e}return null},y=async()=>{let e=(0,o._)();if(e){m(!0);try{var a,l,r,s,n,d,h,g,x,f,p,w,y,N,L,M,W,F,A,E;let o=await i.h.getLogStats(e);if(!o)return;let m=[{label:"Ativos",value:String(null!==(p=null===(a=o.totals)||void 0===a?void 0:a.activeModerators)&&void 0!==p?p:"—"),color:"#10b981"},{label:"Warnings",value:String(null!==(w=null===(l=o.totals)||void 0===l?void 0:l.warnings)&&void 0!==w?w:"—"),color:"#f59e0b"},{label:"Bans",value:String(null!==(y=null===(r=o.totals)||void 0===r?void 0:r.bans)&&void 0!==y?y:"—"),color:"#ef4444"},{label:"Kicks",value:String(null!==(N=null===(s=o.totals)||void 0===s?void 0:s.kicks)&&void 0!==N?N:"—"),color:"#f97316"},{label:"Tickets",value:String(null!==(L=null===(n=o.totals)||void 0===n?void 0:n.tickets)&&void 0!==L?L:"—"),color:"#6366f1"},{label:"Mod logs",value:String(null!==(M=null===(d=o.totals)||void 0===d?void 0:d.logs)&&void 0!==M?M:"—"),color:"#22d3ee"}];t(m);let P=o.updatedAt?new Date(o.updatedAt):new Date;c(P.toLocaleString());let O=null!==(W=null===(h=o.totals)||void 0===h?void 0:h.warnings)&&void 0!==W?W:0,R=null!==(F=null===(g=o.totals)||void 0===g?void 0:g.bans)&&void 0!==F?F:0,T=null!==(A=null===(x=o.totals)||void 0===x?void 0:x.kicks)&&void 0!==A?A:0,U=null!==(E=null===(f=o.totals)||void 0===f?void 0:f.tickets)&&void 0!==E?E:0;v("Resumo r\xe1pido: ".concat(O," warnings, ").concat(R," bans, ").concat(T," kicks, ").concat(U," tickets."));let I=b(o);u(j(I));let B=S(o);k(j(B))}catch(e){}finally{m(!1)}}};return(0,r.useEffect)(()=>{try{let e=localStorage.getItem("dash-refresh-mins"),t=new URLSearchParams(window.location.search),a=f,l=null==t?void 0:t.get("refresh");l?a=(e=>{let t=e.trim().toLowerCase();if("off"===t||"0"===t)return 0;if(t.endsWith("s"))return Math.max(0,parseFloat(t.slice(0,-1))/60);if(t.endsWith("m"))return Math.max(0,parseFloat(t.slice(0,-1)));let a=parseFloat(t);return isNaN(a)?1:Math.max(0,a)})(l):e&&(a=Math.max(0,parseFloat(e))),p(a)}catch(e){}y()},[]),(0,r.useEffect)(()=>{x.current&&(clearInterval(x.current),x.current=null),f>0&&(x.current=setInterval(y,6e4*f));try{localStorage.setItem("dash-refresh-mins",String(f))}catch(e){}return()=>{x.current&&clearInterval(x.current)}},[f]),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"card p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-sm font-semibold text-neutral-200",children:"Status & Resumo"}),(0,l.jsx)("p",{className:"text-xs text-neutral-400 mt-1",children:h}),(0,l.jsxs)("p",{className:"text-xs text-neutral-400 mt-1",children:["\xdaltima atividade: ",d]}),(0,l.jsxs)("p",{className:"text-xs text-neutral-400 mt-1",children:["\xdaltimo ticket: ",w]})]}),(0,l.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,l.jsxs)("div",{className:"text-xs text-neutral-400 flex items-center gap-2",children:[g&&(0,l.jsx)("span",{className:"inline-block h-3 w-3 rounded-full border-2 border-neutral-500 border-t-transparent animate-spin","aria-label":"Atualizando"}),(0,l.jsxs)("span",{children:[g?"Atualizando…":"Atualizado",": ",a]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("label",{className:"text-xs text-neutral-400 hidden sm:flex items-center gap-1",title:"Frequ\xeancia de atualiza\xe7\xe3o",children:[(0,l.jsx)(s.J,{name:"clock",className:"h-4 w-4"}),(0,l.jsxs)("select",{className:"text-xs rounded-md bg-neutral-900 border border-neutral-700 px-2 py-1",value:f,onChange:e=>p(parseFloat(e.target.value)),"aria-label":"Frequ\xeancia de atualiza\xe7\xe3o",children:[(0,l.jsx)("option",{value:0,children:"Off"}),(0,l.jsx)("option",{value:.1667,children:"10s"}),(0,l.jsx)("option",{value:.5,children:"30s"}),(0,l.jsx)("option",{value:1,children:"1m"}),(0,l.jsx)("option",{value:2,children:"2m"}),(0,l.jsx)("option",{value:5,children:"5m"})]})]}),(0,l.jsxs)("button",{className:"inline-flex items-center gap-1 px-2.5 py-1.5 rounded-md border border-neutral-700 bg-neutral-800 hover:bg-neutral-700 text-xs",onClick:()=>y(),disabled:g,title:"Atualizar agora",children:[(0,l.jsx)(s.J,{name:"refresh",className:"h-4 w-4"}),"Atualizar"]})]})]})]})}),(0,l.jsx)("div",{className:"grid grid-cols-3 gap-3",children:e.map(e=>(0,l.jsx)(n,{label:e.label,value:e.value,dotColor:e.color},e.label))})]})}},2695:function(e,t,a){"use strict";a.d(t,{J:function(){return r}});var l=a(7437);function r(e){let{name:t,className:a="h-5 w-5",stroke:r="currentColor"}=e;switch(t){case"dashboard":return(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:a,stroke:r,children:[(0,l.jsx)("rect",{x:"3",y:"10",width:"4",height:"10",rx:"1.5",strokeWidth:"1.6"}),(0,l.jsx)("rect",{x:"10",y:"4",width:"4",height:"16",rx:"1.5",strokeWidth:"1.6"}),(0,l.jsx)("rect",{x:"17",y:"13",width:"4",height:"7",rx:"1.5",strokeWidth:"1.6"})]});case"plugins":return(0,l.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",className:a,stroke:r,xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M9 3h3a2 2 0 0 1 2 2v1h1a2 2 0 1 1 0 4h-1v2a2 2 0 0 1-2 2H9v1a2 2 0 1 1-4 0v-1H4a2 2 0 1 1 0-4h1V8a5 5 0 0 1 4-5Z",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})});case"settings":return(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:a,stroke:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("path",{d:"M12 8.5a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7Z",strokeWidth:"1.6"}),(0,l.jsx)("path",{d:"M3 12h2.2M18.8 12H21M6.2 6.2l1.6 1.1M16.2 16.7l1.6 1.1M6.2 17.8l1.6-1.1M16.2 7.3l1.6-1.1",strokeWidth:"1.6",strokeLinecap:"round"})]});case"tickets":return(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:a,stroke:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("path",{d:"M4 8a2 2 0 0 1 2-2h10l4 4v6a2 2 0 0 1-2 2H8l-4-4V8Z",strokeWidth:"1.6"}),(0,l.jsx)("path",{d:"M15 6v12",strokeWidth:"1.6",strokeDasharray:"2 2"})]});case"shield":return(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:a,stroke:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("path",{d:"M12 3 5 6v6a9 9 0 0 0 7 8 9 9 0 0 0 7-8V6l-7-3Z",strokeWidth:"1.6",strokeLinejoin:"round"}),(0,l.jsx)("path",{d:"M9.5 12.5 11 14l3.5-3.5",strokeWidth:"1.6",strokeLinecap:"round"})]});case"tag":return(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:a,stroke:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("path",{d:"M3 12V6a2 2 0 0 1 2-2h6l10 10-6 6L3 12Z",strokeWidth:"1.6",strokeLinejoin:"round"}),(0,l.jsx)("circle",{cx:"8",cy:"8",r:"1.2",fill:r})]});case"info":return(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:a,stroke:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("circle",{cx:"12",cy:"12",r:"9",strokeWidth:"1.6"}),(0,l.jsx)("path",{d:"M12 10v6",strokeWidth:"1.6",strokeLinecap:"round"}),(0,l.jsx)("circle",{cx:"12",cy:"7",r:"1.2",fill:r})]});case"refresh":return(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:a,stroke:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("path",{d:"M20 12a8 8 0 1 1-2.34-5.66",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"}),(0,l.jsx)("path",{d:"M20 4v5h-5",strokeWidth:"1.6",strokeLinecap:"round",strokeLinejoin:"round"})]});case"clock":return(0,l.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",className:a,stroke:r,xmlns:"http://www.w3.org/2000/svg",children:[(0,l.jsx)("circle",{cx:"12",cy:"12",r:"9",strokeWidth:"1.6"}),(0,l.jsx)("path",{d:"M12 7v6l4 2",strokeWidth:"1.6",strokeLinecap:"round"})]})}}a(2265)},9988:function(e,t,a){"use strict";a.d(t,{h:function(){return l}});let l={async getLogStats(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",l=await fetch("/api/guild/".concat(e,"/logs/stats").concat(a),{credentials:"include"});if(!l.ok)throw Error("Failed to fetch stats");return l.json()},async getLogs(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",l=await fetch("/api/guild/".concat(e,"/logs").concat(a),{credentials:"include"});if(!l.ok)throw Error("Failed to fetch logs");return l.json()},exportLogsUrl(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"";return"/api/guild/".concat(e,"/logs/export").concat(a)},async getSettings(e){let t=await fetch("/api/guild/".concat(e,"/settings"),{credentials:"include"});if(!t.ok)throw Error("Failed to fetch settings");return t.json()},async postSettings(e,t){let a=await fetch("/api/guild/".concat(e,"/settings"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!a.ok)throw Error("Failed to save settings");return a.json()},async getRoles(e){let t=await fetch("/api/guild/".concat(e,"/roles"),{credentials:"include"});if(!t.ok)throw Error("Failed to fetch roles");return t.json()},async getMembers(e,t){let a=t?new URLSearchParams(Object.entries(t).filter(e=>{let[,t]=e;return null!=t}).map(e=>{let[t,a]=e;return[t,String(a)]})).toString():"",l=await fetch("/api/guild/".concat(e,"/members").concat(a?"?".concat(a):""),{credentials:"include"});if(!l.ok)throw Error("Failed to fetch members");return l.json()},async getCurrentUser(){let e=await fetch("/api/user",{credentials:"include"});if(!e.ok)throw Error("Failed to fetch current user");return e.json()},async getTickets(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",l=await fetch("/api/guild/".concat(e,"/tickets").concat(a),{credentials:"include"});if(!l.ok)throw Error("Failed to fetch tickets");return l.json()},exportTicketsUrl(e,t){let a=t?"?".concat(new URLSearchParams(Object.entries(t).map(e=>{let[t,a]=e;return[t,String(a)]}))):"";return"/api/guild/".concat(e,"/tickets/export").concat(a)},async getTicketDetails(e,t){let a=await fetch("/api/guild/".concat(e,"/tickets/").concat(t),{credentials:"include"});if(!a.ok)throw Error("Failed to fetch ticket details");return a.json()},async getTicketLogs(e,t,a){let l=a?"?".concat(new URLSearchParams(Object.entries(a).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",r=await fetch("/api/guild/".concat(e,"/tickets/").concat(t,"/logs").concat(l),{credentials:"include"});if(!r.ok)throw Error("Failed to fetch ticket logs");return r.json()},async getTicketMessages(e,t,a){let l=a?"?".concat(new URLSearchParams(Object.entries(a).map(e=>{let[t,a]=e;return[t,String(a)]}))):"",r=await fetch("/api/guild/".concat(e,"/tickets/").concat(t,"/messages").concat(l),{credentials:"include"});if(!r.ok)throw Error("Failed to fetch ticket messages");return r.json()},async ticketAction(e,t,a,l){let r=await fetch("/api/guild/".concat(e,"/tickets/").concat(t,"/action"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({action:a,data:l})});if(!r.ok)throw Error("Failed to perform ticket action");return r.json()}}},2837:function(e,t,a){"use strict";function l(){return new URL(window.location.href).searchParams.get("guildId")||localStorage.getItem("guildId")}function r(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],a=(e||"").trim();if(a?localStorage.setItem("guildId",a):localStorage.removeItem("guildId"),t)try{let e=new URL(window.location.href);a?e.searchParams.set("guildId",a):e.searchParams.delete("guildId"),window.history.replaceState({},"",e.toString())}catch(e){}}a.d(t,{J:function(){return r},_:function(){return l}})}},function(e){e.O(0,[231,971,23,744],function(){return e(e.s=1387)}),_N_E=e.O()}]);