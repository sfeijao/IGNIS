/*
 * Placeholder local DOMPurify shim.
 * Replace this file with the official `dompurify.min.js` for full compliance.
 * This minimal shim provides a conservative `DOMPurify.sanitize` implementation
 * to ensure the dashboard remains protected even without the official file.
 */
(function(){
  if (window.DOMPurify && typeof window.DOMPurify.sanitize === 'function') return;

  function basicSanitize(html){
    if (!html || typeof html !== 'string') return '';
    html = html.replace(/\$\{[^}]*\}/g, '');
    html = html.replace(/%24%7B/gi, '');
    html = html.replace(/<script[\s\S]*?>[\s\S]*?<\/script>/gi, '');
    html = html.replace(/\s+on[a-zA-Z]+\s*=\s*"[^"]*"/g, '');
    html = html.replace(/\s+on[a-zA-Z]+\s*=\s*'[^']*'/g, '');
    html = html.replace(/href\s*=\s*"javascript:[^\"]*"/gi, '');
    html = html.replace(/src\s*=\s*"javascript:[^\"]*"/gi, '');
    return html;
  }

  window.DOMPurify = {
    sanitize: function(html, cfg){
      return basicSanitize(html);
    }
  };
})();
